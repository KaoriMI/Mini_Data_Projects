!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=199)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct"},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(69)),r(n(12)),r(n(17))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.METADATA_KEY=r;var i=n(73);e.Container=i.Container;var o=n(5);e.BindingScopeEnum=o.BindingScopeEnum,e.BindingTypeEnum=o.BindingTypeEnum,e.TargetTypeEnum=o.TargetTypeEnum;var s=n(89);e.AsyncContainerModule=s.AsyncContainerModule,e.ContainerModule=s.ContainerModule;var a=n(90);e.injectable=a.injectable;var u=n(91);e.tagged=u.tagged;var c=n(92);e.named=c.named;var l=n(41);e.inject=l.inject,e.LazyServiceIdentifer=l.LazyServiceIdentifer;var f=n(93);e.optional=f.optional;var h=n(94);e.unmanaged=h.unmanaged;var d=n(95);e.multiInject=d.multiInject;var p=n(96);e.targetName=p.targetName;var y=n(97);e.postConstruct=y.postConstruct;var v=n(39);e.MetadataReader=v.MetadataReader;var g=n(8);e.guid=g.guid;var b=n(6);e.decorate=b.decorate;var w=n(44);e.traverseAncerstors=w.traverseAncerstors,e.taggedConstraint=w.taggedConstraint,e.namedConstraint=w.namedConstraint,e.typeConstraint=w.typeConstraint;var _=n(11);e.getServiceIdentifierAsString=_.getServiceIdentifierAsString;var m=n(98);e.multiBindToService=m.multiBindToService},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},e.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},e.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(0);function o(t,e,n,i,o){var s={},a="number"==typeof o,u=void 0!==o&&a?o.toString():n;if(a&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(s=Reflect.getMetadata(t,e));var c=s[u];if(Array.isArray(c))for(var l=0,f=c;l<f.length;l++){var h=f[l];if(h.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+h.key)}else c=[];c.push(i),s[u]=c,Reflect.defineMetadata(t,s,e)}function s(t,e){Reflect.decorate(t,e)}function a(t,e){return function(n,r){e(n,r,t)}}e.tagParameter=function(t,e,n,r){o(i.TAGGED,t,e,r,n)},e.tagProperty=function(t,e,n){o(i.TAGGED_PROP,t.constructor,e,n)},e.decorate=function(t,e,n){"number"==typeof n?s([a(n,t)],e):"string"==typeof n?Reflect.decorate([t],e,n):s([t],e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={stage:"prd",studentApiBaseUrl:"https://studentapi.prtl.co",hubUrl:"https://studentjs.prtl.co/storageHub.html?v2",serviceLayerBaseUrl:"https://reflectorjwt.prtl.co",wishlistServiceBaseUrl:"https://decisionmakingapi.prtl.co",tokenServiceBaseUrl:"https://tokens.prtl.co",wssEndpoint:"wss://studentwebsocketservice.prtl.co/v1",allowedOrigins:[/((www)|(cypress\.rc)|([0-9]{4,16}(-bob)?\.rc))\.mastersportal.((com)|(fyi))/,/((www)|(cypress\.rc)|([0-9]{4,16}(-bob)?\.rc))\.bachelorsportal\.((com)|(fyi))/,/((www)|(cypress\.rc)|([0-9]{4,16}(-bob)?\.rc))\.phdportal\.((com)|(fyi))/,/((www)|(cypress\.rc)|([0-9]{4,16}(-bob)?\.rc))\.preparationcoursesportal\.((com)|(fyi))/,/((www)|(cypress\.rc)|([0-9]{4,16}(-bob)?\.rc))\.distancelearningportal\.((com)|(fyi))/,/((www)|(cypress\.rc)|([0-9]{4,16}(-bob)?\.rc))\.shortcoursesportal\.((com)|(fyi))/,/personalitytest\.studyportals\.com/,/countrytest\.studyportals\.com/,/scholarship\.mastersportal\.com/]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.guid=function(){function t(){return Math.floor(65536*(Math.random()+1)).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r extends Error{constructor(t){super(t),this.name="WishlistException"}}e.WishlistException=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.callback=t}return t.prototype.notify=function(t){try{this.callback(t)}catch(t){}},t}();e.CallbackSubscriber=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3);function i(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function o(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+e}e.getServiceIdentifierAsString=i,e.listRegisteredBindingsForServiceIdentifier=function(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(t){var e="Object";null!==t.implementationType&&(e=o(t.implementationType)),r=r+"\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)}))),r},e.circularDependencyToException=function t(e){e.childRequests.forEach((function(e){if(function t(e,n){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===n||t(e.parentRequest,n))}(e,e.serviceIdentifier)){var n=function(t){return function t(e,n){void 0===n&&(n=[]);var r=i(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}(e);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}t(e)}))},e.listMetadataForTarget=function(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(t){n+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+n}return" "+t},e.getFunctionName=o},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(99)),r(n(46)),r(n(48)),r(n(110))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return fetch(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(58);e.DI=r.DI},function(t,e,n){"use strict";(function(t){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(7);e.CatchReportAsyncException=function(t,e,n){var o=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o.apply(this,t)];case 1:return[2,n.sent()];case 2:throw e=n.sent(),a&&a.error(e,t),e;case 3:return[2]}}))}))},n},e.CatchReportException=function(t,e,n){var r=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return r.apply(this,t)}catch(e){throw a&&a.error(e,t),e}},n};var s={accessToken:"a0e7bd5089784ef6b69e99066c272f2f",captureUncaught:!1,captureUnhandledRejections:!1,payload:{environment:o.default.stage}},a=t&&t.rollbar?new t.rollbar(s):null}).call(this,n(18))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Credentials=function(t,e){this.accessToken=t,this.refreshToken=e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(51))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.config=t}return t._getUri=function(){return window.location.toString()},t.prototype.track=function(e,n){void 0===n&&(n=!1),e.url=t._getUri(),this.config.tags=this.config.tags||[];var r=this._cleanCombineTwoArrays(e.tags,this.config.tags);if(e=Object.assign(e,this.config),r.length>0&&(e.tags=r),!n)return this._sendRequest(t._getRequestOptions(e),n);this._sendRequest(t._getRequestOptions(e),n)},t.prototype.addConstantTag=function(t){if("string"==typeof t){var e=!1;this.config.tags=this.config.tags||[],this.config.tags.map((function(n){n.toLowerCase()===t.toLowerCase()&&(e=!0)})),e||this.config.tags.push(t)}},t.prototype._cleanCombineTwoArrays=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);var n=t.concat(e);return n.filter((function(t,e){return n.indexOf(t)===e}))},t.prototype._sendRequest=function(t,e){return void 0===e&&(e=!1),new Promise((function(n,r){var i=new XMLHttpRequest;e&&(i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(200===i.status?n(JSON.parse(i.responseText)):r(JSON.parse(i.responseText)))}),i.open(t.method,t.url),i.setRequestHeader("Content-Type","application/json"),i.send(t.body)}))},t._getRequestOptions=function(t){return{url:"https://c6coiy9r7a.execute-api.eu-west-1.amazonaws.com/prd/events",method:"PUT",body:JSON.stringify(t)}},t}();e.default=r},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.RestCallType||(e.RestCallType={})).GET="GET",r.POST="POST",r.PATCH="PATCH",r.OPTIONS="OPTIONS",r.DELETE="DELETE"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(22),i=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new r.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(21),i=n(44),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=i.namedConstraint(t),new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=i.taggedConstraint(t)(e),new r.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return i.typeConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return i.namedConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return i.taggedConstraint(t)(e)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=o},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(112)),r(n(49)),r(n(118))},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=n(12),s=n(2);let a=class{constructor(t){this.wishlistRepository=t,this.wishlistStateValidator=new o.WishlistStateValidator}getWishlist(t,e){return i(this,void 0,void 0,(function*(){const n=yield this.wishlistRepository.retrieveByUserId(t);if(null===n)throw new o.WishlistNotFound(t);return this.wishlistStateValidator.validate(n,e),n}))}};a=r([s.injectable()],a),e.BaseWishlistCommandHandler=a},function(t,e,n){"use strict";var r=new(n(54).DataStorage);r.init(),t.exports={DataStorage:r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(134),o=function(){function t(){}return t.translateSerializedWishlist=function(e){var n=new r.Wishlist(e.userId);return e.favourites.forEach((function(e){var i=t.createStudy(e),o=new Date(e.dateAdded),s=new r.Favourite(i,o);n.addFavourite(s)})),n},t.createStudy=function(e){var n=e.study,i=new r.Study(n.id);return i.title=n.title,i.isPublic=n.isPublic,i.degreeType=n.degreeType,i.duration=n.duration,i.logo=n.logo,i.tuitionFees=n.tuitionFees,i.applicationDeadlines=t.parseDeadlines(n.applicationDeadlines),i.level=n.level,i.isPremium=n.isPremium,i.Venue=n.venue,i.University=n.university,i.referralLink=t.parseReferralLink(n.referralLink),i},t.parseReferralLink=function(t){if(null==t)return null;var e=t.tracking,n=new i.Tracking(e.googleAnalyticsTracking,e.action,e.type,e.id,e.description,e.label,e.extra);return new i.TrackedLink(n,t.url,t.description)},t.parseDeadlines=function(t){return null==t?null:t.map((function(t){return t.start=new Date(t.start),t.deadline&&(t.deadline=new Date(t.deadline)),t}))},t}();e.WishlistFactory=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(60))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(34);e.Actions=r.default;var i=n(35);e.Labels=i.default;var o=n(36);e.Tags=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.isOpen=!1,this.isOpeningPromisePresent=!1,this.isReadyCallback=function(){}}return t.prototype.open=function(){this.isOpen=!0,this.isReadyCallback(),this.reset()},t.prototype.close=function(){this.isOpen=!1,this.reset()},t.prototype.reset=function(){this.isReadyCallback=function(){},this.isOpeningPromisePresent=!1},t.prototype.untilOpen=function(){var t=this;return this.isOpeningPromisePresent?this.isOpeningPromisePresent:this.isOpeningPromisePresent=new Promise((function(e){t.isOpen?e():t.isReadyCallback=e}))},t}();e.Deferred=r},function(t,e,n){t.exports={CrossStorageClient:n(31),CrossStorageHub:n(32)}},function(t,e,n){!function(n){function r(t,e){var n;e=e||{},this._id=r._generateUUID(),this._promise=e.promise||Promise,this._frameId=e.frameId||"CrossStorageClient-"+this._id,this._origin=r._getOrigin(t),this._requests={},this._connected=!1,this._closed=!1,this._count=0,this._timeout=e.timeout||5e3,this._listener=null,this._installListener(),e.frameId&&(n=document.getElementById(e.frameId)),n&&this._poll(),n=n||this._createFrame(t),this._hub=n.contentWindow}r.frameStyle={display:"none",position:"absolute",top:"-999px",left:"-999px"},r._getOrigin=function(t){var e;return(e=document.createElement("a")).href=t,e.host||(e=window.location),((e.protocol&&":"!==e.protocol?e.protocol:window.location.protocol)+"//"+e.host).replace(/:80$|:443$/,"")},r._generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},r.prototype.onConnect=function(){var t=this;return this._connected?this._promise.resolve():this._closed?this._promise.reject(new Error("CrossStorageClient has closed")):(this._requests.connect||(this._requests.connect=[]),new this._promise((function(e,n){var r=setTimeout((function(){n(new Error("CrossStorageClient could not connect"))}),t._timeout);t._requests.connect.push((function(t){if(clearTimeout(r),t)return n(t);e()}))})))},r.prototype.set=function(t,e){return this._request("set",{key:t,value:e})},r.prototype.get=function(t){var e=Array.prototype.slice.call(arguments);return this._request("get",{keys:e})},r.prototype.del=function(){var t=Array.prototype.slice.call(arguments);return this._request("del",{keys:t})},r.prototype.clear=function(){return this._request("clear")},r.prototype.getKeys=function(){return this._request("getKeys")},r.prototype.close=function(){var t=document.getElementById(this._frameId);t&&t.parentNode.removeChild(t),window.removeEventListener?window.removeEventListener("message",this._listener,!1):window.detachEvent("onmessage",this._listener),this._connected=!1,this._closed=!0},r.prototype._installListener=function(){var t=this;this._listener=function(e){var n,r,i;if(!t._closed&&e.data&&"string"==typeof e.data&&("null"===e.origin?"file://":e.origin)===t._origin)if("cross-storage:unavailable"!==e.data){if(-1!==e.data.indexOf("cross-storage:")&&!t._connected){if(t._connected=!0,!t._requests.connect)return;for(n=0;n<t._requests.connect.length;n++)t._requests.connect[n](r);delete t._requests.connect}if("cross-storage:ready"!==e.data){try{i=JSON.parse(e.data)}catch(t){return}i.id&&t._requests[i.id]&&t._requests[i.id](i.error,i.result)}}else{if(t._closed||t.close(),!t._requests.connect)return;for(r=new Error("Closing client. Could not access localStorage in hub."),n=0;n<t._requests.connect.length;n++)t._requests.connect[n](r)}},window.addEventListener?window.addEventListener("message",this._listener,!1):window.attachEvent("onmessage",this._listener)},r.prototype._poll=function(){var t,e,n;n="file://"===(t=this)._origin?"*":t._origin,e=setInterval((function(){if(t._connected)return clearInterval(e);t._hub&&t._hub.postMessage("cross-storage:poll",n)}),1e3)},r.prototype._createFrame=function(t){var e,n;for(n in(e=window.document.createElement("iframe")).id=this._frameId,r.frameStyle)r.frameStyle.hasOwnProperty(n)&&(e.style[n]=r.frameStyle[n]);return window.document.body.appendChild(e),e.src=t,e},r.prototype._request=function(t,e){var n,r;return this._closed?this._promise.reject(new Error("CrossStorageClient has closed")):((r=this)._count++,n={id:this._id+":"+r._count,method:"cross-storage:"+t,params:e},new this._promise((function(t,e){var i,o,s;i=setTimeout((function(){r._requests[n.id]&&(delete r._requests[n.id],e(new Error("Timeout: could not perform "+n.method)))}),r._timeout),r._requests[n.id]=function(o,s){if(clearTimeout(i),delete r._requests[n.id],o)return e(new Error(o));t(s)},Array.prototype.toJSON&&(o=Array.prototype.toJSON,Array.prototype.toJSON=null),s="file://"===r._origin?"*":r._origin,r._hub.postMessage(JSON.stringify(n),s),o&&(Array.prototype.toJSON=o)})))},t.exports?t.exports=r:e.CrossStorageClient=r}()},function(t,e,n){var r;r={init:function(t){var e=!0;try{window.localStorage||(e=!1)}catch(t){e=!1}if(!e)try{return window.parent.postMessage("cross-storage:unavailable","*")}catch(t){return}r._permissions=t||[],r._installListener(),window.parent.postMessage("cross-storage:ready","*")},_installListener:function(){var t=r._listener;window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent("onmessage",t)},_listener:function(t){var e,n,i,o,s,a,u;if(e="null"===t.origin?"file://":t.origin,"cross-storage:poll"===t.data)return window.parent.postMessage("cross-storage:ready",t.origin);if("cross-storage:ready"!==t.data){try{i=JSON.parse(t.data)}catch(t){return}if(i&&"string"==typeof i.method&&(o=i.method.split("cross-storage:")[1])){if(r._permitted(e,o))try{a=r["_"+o](i.params)}catch(t){s=t.message}else s="Invalid permissions for "+o;u=JSON.stringify({id:i.id,error:s,result:a}),n="file://"===e?"*":e,window.parent.postMessage(u,n)}}},_permitted:function(t,e){var n,i,o;if(n=["get","set","del","clear","getKeys"],!r._inArray(e,n))return!1;for(i=0;i<r._permissions.length;i++)if((o=r._permissions[i]).origin instanceof RegExp&&o.allow instanceof Array&&o.origin.test(t)&&r._inArray(e,o.allow))return!0;return!1},_set:function(t){window.localStorage.setItem(t.key,t.value)},_get:function(t){var e,n,r,i;for(e=window.localStorage,n=[],r=0;r<t.keys.length;r++){try{i=e.getItem(t.keys[r])}catch(t){i=null}n.push(i)}return n.length>1?n:n[0]},_del:function(t){for(var e=0;e<t.keys.length;e++)window.localStorage.removeItem(t.keys[e])},_clear:function(){window.localStorage.clear()},_getKeys:function(t){var e,n,r;for(r=[],n=window.localStorage.length,e=0;e<n;e++)r.push(window.localStorage.key(e));return r},_inArray:function(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1},_now:function(){return"function"==typeof Date.now?Date.now():(new Date).getTime()}},t.exports?t.exports=r:e.CrossStorageHub=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(25),s=function(){function t(){}return t.prototype.get=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,o.DataStorage.retrieve(t)]}))}))},t.prototype.set=function(t,e,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){return[2,o.DataStorage.store(t,e,n)]}))}))},t.prototype.remove=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,o.DataStorage.remove(t)]}))}))},t}();e.DataStorageDriver=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={General:"General",JWTAuth:"JWTAuth",StudentsAPIRequest:"StudentsAPIRequest",SLRequest:"SLRequest"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={JSError:"JSError",JWTAuthError:"JWTAuthError",StudentsAPIError:"StudentsAPIError",SLError:"SLError"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={Error:"Error"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(27),i=n(61),o=n(62),s=n(63),a=function(){function t(t){this.webSocketGateway=t,this.sessionCreated=new i.EventEmitter,this.sessionRefreshed=new i.EventEmitter,this.sessionDestroyed=new i.EventEmitter,this.sessionServiceReady=new i.EventEmitter,this.sessionRepositoryReady=new i.EventEmitter,this.wishlistServiceReady=new i.EventEmitter,this.favouriteAdded=new i.EventEmitter,this.favouriteRemoved=new i.EventEmitter,this.wishlistOrderChanged=new i.EventEmitter,this.groupEventEmitter=new o.GroupEventEmitter}return t.prototype.subscribeToSessionCreatedEvent=function(t){this.sessionCreated.subscribe(t)},t.prototype.publishSessionCreatedEvent=function(t){this.sessionCreated.notify(new r.SessionCreatedEvent(t))},t.prototype.subscribeToSessionRefreshedEvent=function(t){this.sessionRefreshed.subscribe(t)},t.prototype.publishSessionRefreshedEvent=function(){this.sessionRefreshed.notify()},t.prototype.subscribeToSessionDestroyedEvent=function(t){this.sessionDestroyed.subscribe(t)},t.prototype.publishSessionDestroyedEvent=function(){this.sessionDestroyed.notify()},t.prototype.subscribeToSessionServiceReadyEvent=function(t){this.sessionServiceReady.subscribe(t)},t.prototype.publishSessionServiceReadyEvent=function(t){this.sessionServiceReady.notify(t)},t.prototype.subscribeToSessionRepositoryReadyEvent=function(t){this.sessionRepositoryReady.subscribe(t)},t.prototype.publishSessionRepositoryReadyEvent=function(){this.sessionRepositoryReady.notify()},t.prototype.subscribeToWishlistServiceReadyEvent=function(t){this.wishlistServiceReady.subscribe(t)},t.prototype.publishWishlistServiceReadyEvent=function(t){this.wishlistServiceReady.notify(t)},t.prototype.subscribeToFavouriteAddedEvent=function(t){this.favouriteAdded.subscribe(t)},t.prototype.publishFavouriteAddedEvent=function(t){this.favouriteAdded.notify(t)},t.prototype.subscribeToFavouriteRemovedEvent=function(t){this.favouriteRemoved.subscribe(t)},t.prototype.publishFavouriteRemovedEvent=function(t){this.favouriteRemoved.notify(t)},t.prototype.subscribeToWishlistOrderChangedEvent=function(t){this.wishlistOrderChanged.subscribe(t)},t.prototype.publishWishlistOrderChangedEvent=function(t){this.wishlistOrderChanged.notify(t)},t.prototype.subscribeToWebSocketEvent=function(t,e){this.webSocketGateway.addSubscriber(new s.WebSocketGatewaySubscriber(t,e))},t.prototype.subscribeTo=function(t,e){this.groupEventEmitter.subscribe(t,e)},t.prototype.publishTo=function(t,e){this.groupEventEmitter.notify(t,e)},t}();e.EventAggregationService=a},function(t,e,n){(function(t,e){var n;!function(n){!function(r){var i="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=s(n);function s(t,e){return function(n,r){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}void 0===i.Reflect?i.Reflect=n:o=s(i.Reflect,o),function(e){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,u=!s&&!a,c={create:s?function(){return k(Object.create(null))}:a?function(){return k({__proto__:null})}:function(){return k({})},has:u?function(t,e){return n.call(t,e)}:function(t,e){return e in t},get:u?function(t,e){return n.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},l=Object.getPrototypeOf(Function),f="object"==typeof t&&Object({NODE_ENV:"production"})&&"true"===Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL,h=f||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,i)},e.prototype.entries=function(){return new n(this._keys,this._values,s)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function i(t,e){return e}function s(t,e){return[t,e]}}():Map,d=f||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new h}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}():Set,p=new(f||"function"!=typeof WeakMap?function(){var t=c.create(),e=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=i(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=i(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return i(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=i(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var e;do{e="@@WeakMap@@"+s()}while(c.has(t,e));return t[e]=!0,e}function i(t,r){if(!n.call(t,e)){if(!r)return;Object.defineProperty(t,e,{value:c.create()})}return t[e]}function o(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function s(){var t="function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(16)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(16)):o(new Uint8Array(16),16):o(new Array(16),16);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var e="",n=0;n<16;++n){var r=t[n];4!==n&&6!==n&&8!==n||(e+="-"),r<16&&(e+="0"),e+=r.toString(16).toLowerCase()}return e}}():WeakMap);function y(t,e,n){var r=p.get(t);if(m(r)){if(!n)return;r=new h,p.set(t,r)}var i=r.get(e);if(m(i)){if(!n)return;i=new h,r.set(e,i)}return i}function v(t,e,n){var r=y(e,n,!1);return!m(r)&&!!r.has(t)}function g(t,e,n){var r=y(e,n,!1);if(!m(r))return r.get(t)}function b(t,e,n,r){y(n,r,!0).set(t,e)}function w(t,e){var n=[],r=y(t,e,!1);if(m(r))return n;for(var i=function(t){var e=I(t,o);if(!O(e))throw new TypeError;var n=e.call(t);if(!E(n))throw new TypeError;return n}(r.keys()),s=0;;){var a=P(i);if(!a)return n.length=s,n;var u=a.value;try{n[s]=u}catch(t){try{C(i)}finally{throw t}}s++}}function _(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function m(t){return void 0===t}function S(t){return null===t}function E(t){return"object"==typeof t?null!==t:"function"==typeof t}function T(t){var e=function(t,e){switch(_(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=I(t,i);if(void 0!==n){var r=n.call(t,"string");if(E(r))throw new TypeError;return r}return function(t,e){var n,r,i=t.toString;if(O(i)&&!E(r=i.call(t)))return r;if(O(n=t.valueOf)&&!E(r=n.call(t)))return r;throw new TypeError}(t)}(t);return"symbol"==typeof e?e:function(t){return""+t}(e)}function A(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function O(t){return"function"==typeof t}function R(t){return"function"==typeof t}function I(t,e){var n=t[e];if(null!=n){if(!O(n))throw new TypeError;return n}}function P(t){var e=t.next();return!e.done&&e}function C(t){var e=t.return;e&&e.call(t)}function x(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===l)return e;if(e!==l)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!=typeof i||i===t?e:i}function k(t){return t.__=void 0,delete t.__,t}e("decorate",(function(t,e,n,r){if(m(n)){if(!A(t))throw new TypeError;if(!R(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!m(r)&&!S(r)){if(!R(r))throw new TypeError;e=r}}return e}(t,e)}if(!A(t))throw new TypeError;if(!E(e))throw new TypeError;if(!E(r)&&!m(r)&&!S(r))throw new TypeError;return S(r)&&(r=void 0),function(t,e,n,r){for(var i=t.length-1;i>=0;--i){var o=(0,t[i])(e,n,r);if(!m(o)&&!S(o)){if(!E(o))throw new TypeError;r=o}}return r}(t,e,n=T(n),r)})),e("metadata",(function(t,e){return function(n,r){if(!E(n))throw new TypeError;if(!m(r)&&!function(t){switch(_(t)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;b(t,e,n,r)}})),e("defineMetadata",(function(t,e,n,r){if(!E(n))throw new TypeError;return m(r)||(r=T(r)),b(t,e,n,r)})),e("hasMetadata",(function(t,e,n){if(!E(e))throw new TypeError;return m(n)||(n=T(n)),function t(e,n,r){if(v(e,n,r))return!0;var i=x(n);return!S(i)&&t(e,i,r)}(t,e,n)})),e("hasOwnMetadata",(function(t,e,n){if(!E(e))throw new TypeError;return m(n)||(n=T(n)),v(t,e,n)})),e("getMetadata",(function(t,e,n){if(!E(e))throw new TypeError;return m(n)||(n=T(n)),function t(e,n,r){if(v(e,n,r))return g(e,n,r);var i=x(n);return S(i)?void 0:t(e,i,r)}(t,e,n)})),e("getOwnMetadata",(function(t,e,n){if(!E(e))throw new TypeError;return m(n)||(n=T(n)),g(t,e,n)})),e("getMetadataKeys",(function(t,e){if(!E(t))throw new TypeError;return m(e)||(e=T(e)),function t(e,n){var r=w(e,n),i=x(e);if(null===i)return r;var o=t(i,n);if(o.length<=0)return r;if(r.length<=0)return o;for(var s=new d,a=[],u=0,c=r;u<c.length;u++){var l=c[u];s.has(l)||(s.add(l),a.push(l))}for(var f=0,h=o;f<h.length;f++)l=h[f],s.has(l)||(s.add(l),a.push(l));return a}(t,e)})),e("getOwnMetadataKeys",(function(t,e){if(!E(t))throw new TypeError;return m(e)||(e=T(e)),w(t,e)})),e("deleteMetadata",(function(t,e,n){if(!E(e))throw new TypeError;m(n)||(n=T(n));var r=y(e,n,!1);if(m(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=p.get(e);return i.delete(n),i.size>0||p.delete(e),!0}))}(o)}()}(n||(n={}))}).call(this,n(67),n(18))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(r.TAGGED_PROP,t)||[]},t}();e.MetadataReader=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3);e.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===r.STACK_OVERFLOW}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(0),o=n(4),s=n(6),a=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();e.LazyServiceIdentifer=a,e.inject=function(t){return function(e,n,a){if(void 0===t)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(e.name));var u=new o.Metadata(i.INJECT_TAG,t);"number"==typeof a?s.tagParameter(e,n,a,u):s.tagProperty(e,n,u)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(8),o=n(4),s=n(80),a=function(){function t(t,e,n,a){this.guid=i.guid(),this.type=t,this.serviceIdentifier=n,this.name=new s.QueryableString(e||""),this.metadata=new Array;var u=null;"string"==typeof a?u=new o.Metadata(r.NAMED_TAG,a):a instanceof o.Metadata&&(u=a),null!==u&&this.metadata.push(u)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++)if(n[e].key===t)return!0;return!1},t.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(r.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG}))},t.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===r.NAMED_TAG}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(r.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var r=0,i=e.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===n)return!0}return!1}},t}();e.Target=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(21),i=n(22),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=function(t,e){var n=t.parentRequest;return null!==n&&(!!e(n)||o(n,e))};e.traverseAncerstors=o;var s=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new i.Metadata(t,e),n}};e.taggedConstraint=s;var a=s(r.NAMED_TAG);e.namedConstraint=a,e.typeConstraint=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"==typeof t)return n.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Study=class{constructor(t){this.id=t}get Venue(){return this.venue}set Venue(t){this.venue=t}get University(){return this.university}set University(t){this.university=t}}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(102)),r(n(103)),r(n(47)),r(n(104)),r(n(105)),r(n(9))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);class i extends r.WishlistException{constructor(){super("ExpectedState doesn't match current state of wishlist"),this.name="IncorrectWishlistState"}}e.IncorrectWishlistState=i},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(106)),r(n(109))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(117))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(23);class i extends r.DomainEvent{constructor(t,e,n,r,o){super(r),this.userId=t,this.targetStudyId=e,this.referenceStudyId=n,this.eventId=r,this.dateChanged=o,this.eventType=i.eventName,this.eventVersion="1.0.0"}static create(t,e,n,o=new Date){return new i(t,e,n,r.DomainEvent.generateId(),o)}}i.eventName="WishlistOrderChanged",e.WishlistOrderChanged=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);class i{}i.container=new r.Container,i.EVENT_EMITTER=Symbol("EventEmitter"),i.WISHLIST_REPOSITORY=Symbol("WishlistRepository"),e.DICore=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);class i extends r.WishlistException{constructor(t){super("Invalid study id, expected to be of type number: "+JSON.stringify(t)),this.studyId=t,this.name="FavouriteInvalidStudyId"}}e.FavouriteInvalidStudyId=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GetWishlistQueryResult=class{constructor(t){this.wishlist=t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.enabled=!1}return t.prototype.init=function(){try{if("undefined"==typeof localStorage)return void(this.enabled=!1);localStorage.setItem("test","dummy value"),localStorage.removeItem("test"),this.enabled=!0}catch(t){this.enabled=!1}},t.prototype.store=function(t,e,n){if(void 0===n&&(n=1800),this.enabled){var r=new Date,i={expires:r.setSeconds(r.getSeconds()+n),data:e};localStorage[t]=JSON.stringify(i)}else document.cookie=t+"="+e+";expires="+n/86400;return!0},t.prototype.retrieve=function(t){if(this.enabled){var e=localStorage[t];try{e=JSON.parse(e)}catch(t){e={}}if(!e||!e.hasOwnProperty("expires")||!e.hasOwnProperty("data"))return"";var n=parseInt(e.expires,10);return isNaN(n)&&(n=0),new Date>=new Date(n)?(localStorage[t]=null,""):e.data}return this.getCookie(t)},t.prototype.remove=function(t){this.enabled?delete localStorage[t]:document.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"},t.prototype.update=function(t,e,n){var r=this.retrieve(t);return"object"!=typeof r&&(r={}),r=Object.assign({},r,e),this.store(t,r,n),r},t.prototype.getCookie=function(t){var e=RegExp(t+"=.[^;]*"),n=document.cookie.match(e);return n?n[0].split("=")[1]:""},t}();e.DataStorage=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TrackedLink=void 0;var r=function(){function t(t,e,n){void 0===n&&(n=null),this.tracking=t,this.url=e,this.description=n}return t.prototype.getTracking=function(){return this.tracking},t.prototype.getUrl=function(){return this.url},t.prototype.getDescription=function(){if(!this.canShowDescription())throw new Error("No description available for this item");return this.description},t.prototype.canShowDescription=function(){return!this.description},t}();e.TrackedLink=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tracking=void 0;var r=function(){function t(t,e,n,r,i,o,s){this.googleAnalyticsTracking=t,this.action=e,this.type=n,this.id=r,this.description=i,this.label=o,this.extra=s}return t.prototype.getAction=function(){return this.action},t.prototype.getDescription=function(){return this.description},t.prototype.getExtra=function(){return this.extra},t.prototype.getGoogleAnalyticsTracking=function(){return this.googleAnalyticsTracking},t.prototype.getId=function(){return this.id},t.prototype.getLabel=function(){return this.label},t.prototype.getType=function(){return this.type},t}();e.Tracking=r},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.PremiumVariantType=void 0,(r=e.PremiumVariantType||(e.PremiumVariantType={})).VARIANT_DEFAULT="default",r.VARIANT_OUT_OF_RANGE="ooRange",r.VARIANT_OUT_OF_DATE="ooDate"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2);n(38);var i=function(){function t(){}return t.container=new r.Container,t.ADD_TO_WISHLIST_COMMAND_HANDLER=Symbol("AddToWishlistCommandHandler"),t.REMOVE_FROM_WISHLIST_COMMAND_HANDLER=Symbol("RemoveFromWishlistCommandHandler"),t.GET_WISHLIST_COMMAND_HANDLER=Symbol("GetWishlistCommandHandler"),t.SET_WISHLIST_ORDER_COMMAND_HANDLER=Symbol("SetWishlistOrderCommandHandler"),t.LOCAL_WISHLIST_SERVICE=Symbol("LocalWishlistService"),t.REMOTE_WISHLIST_SERVICE=Symbol("RemoteWishlistService"),t.EVENT_AGGREGATION_SERVICE=Symbol("EventAggregationService"),t.LOCALSTORAGE_DRIVER=Symbol("LocalStorageDriver"),t.SESSION_SERVICE=Symbol("SessionService"),t.WISHLIST_BASEURL=Symbol("WishlistBaseUrl"),t.WISHLIST_CACHE=Symbol("WishlistCache"),t.TRACKER=Symbol("Tracker"),t}();e.DI=i},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(2),c=n(26),l=n(14),f=function(){function t(t){this.localStorageDriver=t,this.wishlist=null,this.storageKey="cached-remote-wishlist",this.cacheTTL=3600}return t.prototype.setWishlist=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return this.wishlist=t,[4,this.localStorageDriver.set(this.storageKey,JSON.stringify(this.wishlist),this.cacheTTL)];case 1:return e.sent(),[2]}}))}))},t.prototype.getWishlist=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return null!==this.wishlist?[3,2]:[4,this.localStorageDriver.get(this.storageKey)];case 1:if(""===(t=e.sent())||null===t)return[2,null];this.wishlist=c.WishlistFactory.translateSerializedWishlist(JSON.parse(t)),e.label=2;case 2:return[2,this.wishlist]}}))}))},t.prototype.clearCache=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.wishlist=null,[4,this.localStorageDriver.remove(this.storageKey)];case 1:return t.sent(),[2]}}))}))},r([u.injectable(),o(0,u.inject(l.DI.LOCALSTORAGE_DRIVER)),i("design:paramtypes",[Object])],t)}();e.WishlistCache=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionCreatedEvent=function(t){this.timestamp=new Date,this.session=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.subscribers=[]}return t.prototype.subscribe=function(t){this.subscribers.push(t)},t.prototype.notify=function(t){this.subscribers.forEach((function(e){return e.notify(t)}))},t}();e.EventEmitter=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.subscribers=new Map}return t.prototype.subscribe=function(t,e){var n=this.subscribers.get(t)||[];n.push(e),this.subscribers.set(t,n)},t.prototype.notify=function(t,e){var n=this.subscribers.get(t);n&&n.forEach((function(t){return t.notify(e)}))},t}();e.GroupEventEmitter=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.eventType=t,this.handler=e}return t.prototype.canHandle=function(t){return"string"==typeof this.eventType?this.eventType.toLowerCase()===t.toLowerCase():this.eventType.test(t)},t.prototype.handle=function(t){this.handler.notify(t)},t}();e.WebSocketGatewaySubscriber=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RefreshTokenError=function(t){this.message=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidAccessTokenError=function(t){this.message=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7);n(38);var i=n(68),o={environment:r.default.stage?r.default.stage:"dev",team:"xm",product:"WishlistService",category:"Wishlist"},s=new i.Bootstrapper(window.EventAggregationService,window.SessionService,r.default.wishlistServiceBaseUrl,o);s.configureEnvironment(),s.setupApplication()},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=a(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),s=n(19),a=n(33),u=n(10),c=n(133),l=n(143),f=n(144),h=n(148),d=n(149),p=n(151),y=n(153),v=n(14),g=n(155),b=n(156),w=n(59),_=function(){function t(t,e,n,r){this.eventService=t,this.sessionService=e,this.wishlistBaseUrl=n,this.spTrackerConfig=r,this.localWishlistService=null,this.remoteWishlistService=null,this.localWishlistRepository=null,this.queueWishlistService=new f.QueueWishlistService,this.wishlistCache=null}return t.prototype.configureEnvironment=function(){var t=new a.DataStorageDriver;this.wishlistCache=new w.WishlistCache(t),v.DI.container.bind(v.DI.LOCALSTORAGE_DRIVER).toConstantValue(t),v.DI.container.bind(v.DI.EVENT_AGGREGATION_SERVICE).toConstantValue(this.eventService),v.DI.container.bind(o.DICore.WISHLIST_REPOSITORY).to(b.LocalWishlistRepository),v.DI.container.bind(o.DICore.EVENT_EMITTER).to(g.EventAggregationServiceEventEmitter),v.DI.container.bind(v.DI.ADD_TO_WISHLIST_COMMAND_HANDLER).to(o.DefaultAddToWishlistCommandHandler),v.DI.container.bind(v.DI.REMOVE_FROM_WISHLIST_COMMAND_HANDLER).to(o.DefaultRemoveFromWishlistCommandHandler),v.DI.container.bind(v.DI.SET_WISHLIST_ORDER_COMMAND_HANDLER).to(o.SetWishlistOrderCommandHandler),v.DI.container.bind(v.DI.GET_WISHLIST_COMMAND_HANDLER).to(o.DefaultGetWishlistQueryHandler),v.DI.container.bind(v.DI.SESSION_SERVICE).toConstantValue(this.sessionService),v.DI.container.bind(v.DI.REMOTE_WISHLIST_SERVICE).to(c.DecisionMakingApiWishlistService),v.DI.container.bind(v.DI.LOCAL_WISHLIST_SERVICE).to(l.LocalWishlistService),v.DI.container.bind(v.DI.WISHLIST_BASEURL).toConstantValue(this.wishlistBaseUrl),v.DI.container.bind(v.DI.TRACKER).toConstantValue(new s.default(this.spTrackerConfig)),v.DI.container.bind(v.DI.WISHLIST_CACHE).toConstantValue(this.wishlistCache)},t.prototype.setupApplication=function(){var t=this;this.localWishlistService=new h.RetryCommandWishlistService(v.DI.container.get(v.DI.LOCAL_WISHLIST_SERVICE)),this.localWishlistRepository=v.DI.container.get(o.DICore.WISHLIST_REPOSITORY),this.remoteWishlistService=new h.RetryCommandWishlistService(v.DI.container.get(v.DI.REMOTE_WISHLIST_SERVICE)),this.setupOnSessionServiceReady(),this.eventService.subscribeToSessionCreatedEvent(new u.CallbackSubscriber((function(){return t.onSessionCreated()}))),this.eventService.subscribeToSessionDestroyedEvent(new u.CallbackSubscriber((function(){return t.onSessionDestroyed()}))),new d.WebSocketFavouriteAddedAdapter(this.eventService,this.wishlistCache).initialize(),new p.WebSocketFavouriteRemovedAdapter(this.eventService,this.wishlistCache).initialize(),new y.WebsocketWishlistOrderChangedAdapter(this.eventService,this.wishlistCache).initialize()},t.prototype.setWishlistService=function(t){this.queueWishlistService.setWishlistService(t)},t.prototype.synchroniseLocalWishlistToRemote=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.localWishlistService.getWishlist()];case 1:return null===(t=i.sent())?[3,8]:[4,this.remoteWishlistService.getWishlist()];case 2:for(n in i.sent(),e=[],t.favourites)e.push(n);r=0,i.label=3;case 3:return r<e.length?(o=e[r],s=t.favourites[o],a=s.study.id,[4,this.remoteWishlistService.addFavourite(a)]):[3,6];case 4:i.sent(),i.label=5;case 5:return r++,[3,3];case 6:return[4,this.localWishlistRepository.removeWishlist()];case 7:i.sent(),i.label=8;case 8:return[2]}}))}))},t.prototype.onSessionDestroyed=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.setWishlistService(this.localWishlistService),[4,this.wishlistCache.clearCache()];case 1:return t.sent(),[2]}}))}))},t.prototype.onSessionCreated=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.setWishlistService(this.remoteWishlistService),[4,this.synchroniseLocalWishlistToRemote()];case 1:return t.sent(),[2]}}))}))},t.prototype.setQueueWishlistServiceOnWindow=function(){window.wishlistService=this.queueWishlistService},t.prototype.setupOnSessionServiceReady=function(){var t=this;this.sessionService.isReady&&this.onSessionServiceReady(),this.eventService.subscribeToSessionServiceReadyEvent(new u.CallbackSubscriber((function(){return t.onSessionServiceReady()})))},t.prototype.onSessionServiceReady=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.sessionService.getSession()];case 1:return null===t.sent()?this.setWishlistService(this.localWishlistService):(this.setWishlistService(this.remoteWishlistService),this.synchroniseLocalWishlistToRemote()),this.setQueueWishlistServiceOnWindow(),this.eventService.publishWishlistServiceReadyEvent(this.queueWishlistService),[2]}}))}))},t}();e.Bootstrapper=_},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(70)),r(n(122)),r(n(125)),r(n(128)),r(n(131))},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(71)),r(n(72))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddToWishlistCommand=class{constructor(t,e,n){this.userId=t,this.studyId=e,this.expectedState=n}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=n(2),a=n(12),u=n(17),c=n(52),l=n(24);let f=class extends l.BaseWishlistCommandHandler{constructor(t,e){super(t),this.wishlistRepository=t,this.eventEmitter=e}validate(t){if("number"!=typeof t.studyId)throw new c.FavouriteInvalidStudyId(t.studyId)}handle({studyId:t,userId:e,expectedState:n}){return o(this,void 0,void 0,(function*(){try{this.validate({studyId:t,userId:e,expectedState:n});const r=yield this.getWishlist(e,n),i=a.Favourite.create(t);return r.addFavourite(i),yield this.wishlistRepository.addFavourite(r,i),yield this.emitFavouriteAddedEvent(e,t,i.dateAdded),{resultingState:r.stateHash}}catch(t){if(t instanceof a.StudyAlreadyFavourited)return{resultingState:n};throw t}}))}emitFavouriteAddedEvent(t,e,n){return o(this,void 0,void 0,(function*(){yield this.eventEmitter.emit(a.FavouriteAdded.eventName,a.FavouriteAdded.create(t,e,n))}))}};f=r([s.injectable(),i(0,s.inject(u.DICore.WISHLIST_REPOSITORY)),i(1,s.inject(u.DICore.EVENT_EMITTER))],f),e.DefaultAddToWishlistCommandHandler=f},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(74),s=n(3),a=n(5),u=n(0),c=n(39),l=n(75),f=n(82),h=n(84),d=n(8),p=n(11),y=n(87),v=n(88),g=function(){function t(t){var e=t||{};if("object"!=typeof e)throw new Error(""+s.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=a.BindingScopeEnum.Transient;else if(e.defaultScope!==a.BindingScopeEnum.Singleton&&e.defaultScope!==a.BindingScopeEnum.Transient&&e.defaultScope!==a.BindingScopeEnum.Request)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.guid=d.guid(),this._bindingDictionary=new v.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new c.MetadataReader}return t.merge=function(e,n){var r=new t,i=l.getBindingDictionary(r),o=l.getBindingDictionary(e),s=l.getBindingDictionary(n);function a(t,e){t.traverse((function(t,n){n.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return a(o,i),a(s,i),r},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],s=n(o.guid);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e,n,r,o,s;return i(this,(function(i){switch(i.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,r=t,i.label=1;case 1:return n<r.length?(o=r[n],s=e(o.guid),[4,o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){return function(e){return e.moduleId===t}};e.forEach((function(e){var n=r(e.guid);t._bindingDictionary.removeByCondition(n)}))},t.prototype.bind=function(t){var e=this.options.defaultScope||a.BindingScopeEnum.Transient,n=new o.Binding(t,e);return this._bindingDictionary.add(t,n),new h.BindingToSyntax(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(s.CANNOT_UNBIND+" "+p.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new v.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,u.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=l.createMockRequest(this,t,e,n);r=i.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r},t.prototype.snapshot=function(){this._snapshots.push(y.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(s.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,a.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,a.TargetTypeEnum.Variable,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,u.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,a.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,a.TargetTypeEnum.Variable,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,u.NAMED_TAG,e)},t.prototype.resolve=function(e){var n=new t;return n.bind(e).toSelf(),n.parent=this,n.get(e)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.rebind.bind(t)(r);return e(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=t.bind.bind(t)(n);return e(r,i),r}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:n(r),unbindFunction:function(e){t.unbind.bind(t)(e)}};var i}},t.prototype._get=function(t,e,n,r,i,o){var a=null,u={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(u)))throw new Error(s.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(u);return a},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=l.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return n=e.contextInterceptor(n),f.resolve(n)}},t}();e.Container=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=n(8),o=function(){function t(t,e){this.guid=i.guid(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(76),i=n(3),o=n(5),s=n(0),a=n(40),u=n(11),c=n(77),l=n(4),f=n(78),h=n(79),d=n(81),p=n(42);function y(t){return t._bindingDictionary}function v(t,e,n,o,s){var a,c=g(n.container,s.serviceIdentifier);return c.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof s.serviceIdentifier&&t.getConstructorMetadata(s.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(s.serviceIdentifier).toSelf(),c=g(n.container,s.serviceIdentifier)),a=e?c:c.filter((function(t){var e=new d.Request(t.serviceIdentifier,n,o,t,s);return t.constraint(e)})),function(t,e,n,o){switch(e.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return e;var s=u.getServiceIdentifierAsString(t),a=i.NOT_REGISTERED;throw a+=u.listMetadataForTarget(s,n),a+=u.listRegisteredBindingsForServiceIdentifier(o,s,g),new Error(a);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return e;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return e;throw s=u.getServiceIdentifierAsString(t),a=i.AMBIGUOUS_MATCH+" "+s,a+=u.listRegisteredBindingsForServiceIdentifier(o,s,g),new Error(a)}}(s.serviceIdentifier,a,s,n.container),a}function g(t,e){var n=[],r=y(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=g(t.parent,e)),n}e.getBindingDictionary=y,e.plan=function(t,e,n,r,y,g,b,w){void 0===w&&(w=!1);var _=new c.Context(e),m=function(t,e,n,r,i,o){var a=t?s.MULTI_INJECT_TAG:s.INJECT_TAG,u=new l.Metadata(a,n),c=new p.Target(e,"",n,u);if(void 0!==i){var f=new l.Metadata(i,o);c.metadata.push(f)}return c}(n,r,y,0,g,b);try{return function t(e,n,r,s,a,u){var c,l;if(null===a){c=v(e,n,s,null,u),l=new d.Request(r,s,null,c,u);var p=new f.Plan(s,l);s.addPlan(p)}else c=v(e,n,s,a,u),l=a.addChildRequest(u.serviceIdentifier,c,u);c.forEach((function(n){var r=null;if(u.isArray())r=l.addChildRequest(n.serviceIdentifier,n,u);else{if(n.cache)return;r=l}if(n.type===o.BindingTypeEnum.Instance&&null!==n.implementationType){var a=h.getDependencies(e,n.implementationType);if(!s.container.options.skipBaseClassChecks){var c=h.getBaseClassDependencyCount(e,n.implementationType);if(a.length<c){var f=i.ARGUMENTS_LENGTH_MISMATCH(h.getFunctionName(n.implementationType));throw new Error(f)}}a.forEach((function(n){t(e,!1,n.serviceIdentifier,s,r,n)}))}}))}(t,w,y,_,null,m),_}catch(t){throw a.isStackOverflowExeption(t)&&_.plan&&u.circularDependencyToException(_.plan.rootRequest),t}},e.createMockRequest=function(t,e,n,r){var i=new p.Target(o.TargetTypeEnum.Variable,"",e,new l.Metadata(n,r)),s=new c.Context(t);return new d.Request(e,s,null,[],i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=function(){function t(t){this.guid=r.guid(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plan=function(t,e){this.parentContext=t,this.rootRequest=e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(41),i=n(3),o=n(5),s=n(0),a=n(11);e.getFunctionName=a.getFunctionName;var u=n(42);function c(t,e,n,r){var s=t.getConstructorMetadata(n),a=s.compilerGeneratedMetadata;if(void 0===a){var c=i.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(c)}var h=s.userGeneratedMetadata,d=Object.keys(h),p=function(t,e,n,r,i){for(var o=[],s=0;s<i;s++){var a=l(s,t,e,n,r);null!==a&&o.push(a)}return o}(r,e,a,h,0===n.length&&d.length>0?d.length:n.length),y=function t(e,n){for(var r=e.getPropertiesMetadata(n),i=[],s=0,a=Object.keys(r);s<a.length;s++){var c=a[s],l=r[c],h=f(r[c]),d=h.targetName||c,p=h.inject||h.multiInject,y=new u.Target(o.TargetTypeEnum.ClassProperty,d,p);y.metadata=l,i.push(y)}var v=Object.getPrototypeOf(n.prototype).constructor;if(v!==Object){var g=t(e,v);i=i.concat(g)}return i}(t,n);return p.concat(y)}function l(t,e,n,s,a){var c=a[t.toString()]||[],l=f(c),h=!0!==l.unmanaged,d=s[t];if((d=l.inject||l.multiInject||d)instanceof r.LazyServiceIdentifer&&(d=d.unwrap()),h){if(!e&&(d===Object||d===Function||void 0===d)){var p=i.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".";throw new Error(p)}var y=new u.Target(o.TargetTypeEnum.ConstructorArgument,l.targetName,d);return y.metadata=c,y}return null}function f(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[s.INJECT_TAG],multiInject:e[s.MULTI_INJECT_TAG],targetName:e[s.NAME_TAG],unmanaged:e[s.UNMANAGED_TAG]}}e.getDependencies=function(t,e){return c(t,a.getFunctionName(e),e,!1)},e.getBaseClassDependencyCount=function t(e,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=c(e,a.getFunctionName(r),r,!0),o=i.map((function(t){return t.metadata.filter((function(t){return t.key===s.UNMANAGED_TAG}))})),u=[].concat.apply([],o).length,l=i.length-u;return l>0?l:t(e,r)}return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=function(){function t(t,e,n,i,o){this.guid=r.guid(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i},t}();e.Request=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(5),o=n(40),s=n(11),a=n(83),u=function(t,e,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):n}},c=function(t){return function(e){e.parentContext.setCurrentRequest(e);var n=e.bindings,o=e.childRequests,l=e.target&&e.target.isArray(),f=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(l&&f)return o.map((function(e){return c(t)(e)}));var h=null;if(!e.target.isOptional()||0!==n.length){var d=n[0],p=d.scope===i.BindingScopeEnum.Singleton,y=d.scope===i.BindingScopeEnum.Request;if(p&&d.activated)return d.cache;if(y&&null!==t&&t.has(d.guid))return t.get(d.guid);if(d.type===i.BindingTypeEnum.ConstantValue)h=d.cache;else if(d.type===i.BindingTypeEnum.Function)h=d.cache;else if(d.type===i.BindingTypeEnum.Constructor)h=d.implementationType;else if(d.type===i.BindingTypeEnum.DynamicValue&&null!==d.dynamicValue)h=u("toDynamicValue",d.serviceIdentifier,(function(){return d.dynamicValue(e.parentContext)}));else if(d.type===i.BindingTypeEnum.Factory&&null!==d.factory)h=u("toFactory",d.serviceIdentifier,(function(){return d.factory(e.parentContext)}));else if(d.type===i.BindingTypeEnum.Provider&&null!==d.provider)h=u("toProvider",d.serviceIdentifier,(function(){return d.provider(e.parentContext)}));else{if(d.type!==i.BindingTypeEnum.Instance||null===d.implementationType){var v=s.getServiceIdentifierAsString(e.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+v)}h=a.resolveInstance(d.implementationType,o,c(t))}return"function"==typeof d.onActivation&&(h=d.onActivation(e.parentContext,h)),p&&(d.cache=h,d.activated=!0),y&&null!==t&&!t.has(d.guid)&&t.set(d.guid,h),h}}};e.resolve=function(t){return c(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(5),o=n(0);e.resolveInstance=function(t,e,n){var s,a,u=null;return e.length>0?(a=e.filter((function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ConstructorArgument})).map(n),u=function(t,e,n){var r=e.filter((function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ClassProperty})),o=r.map(n);return r.forEach((function(e,n){var r;r=e.target.name.value();var i=o[n];t[r]=i})),t}(u=new((s=t).bind.apply(s,[void 0].concat(a))),e,n)):u=new t,function(t,e){if(Reflect.hasMetadata(o.POST_CONSTRUCT,t)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,t);try{e[n.value]()}catch(e){throw new Error(r.POST_CONSTRUCT_ERROR(t.name,e.message))}}}(t,u),u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(5),o=n(85),s=n(43),a=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=t,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=t,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(r.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=i.BindingTypeEnum.Function,e},t.prototype.toAutoFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},new s.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=t,new s.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}();e.BindingToSyntax=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(86),i=n(21),o=n(22),s=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=n(43),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.of=function(e,n){var r=new t;return r.bindings=e,r.middleware=n,r},t}();e.ContainerSnapshot=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(r.NULL_ARGUMENT);if(null==e)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(r.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(r.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach((function(n,r){var i=n.filter((function(e){return!t(e)}));i.length>0?e._map.set(r,i):e._map.delete(r)}))},t.prototype.hasKey=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,n){t.forEach((function(t){return e.add(n,t.clone())}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,n){t(n,e)}))},t}();e.Lookup=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.ContainerModule=function(t){this.guid=r.guid(),this.registry=t},e.AsyncContainerModule=function(t){this.guid=r.guid(),this.registry=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(0);e.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,t))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(i.PARAM_TYPES,e,t),t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(6);e.tagged=function(t,e){return function(n,o,s){var a=new r.Metadata(t,e);"number"==typeof s?i.tagParameter(n,o,s,a):i.tagProperty(n,o,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(6);e.named=function(t){return function(e,n,s){var a=new i.Metadata(r.NAMED_TAG,t);"number"==typeof s?o.tagParameter(e,n,s,a):o.tagProperty(e,n,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(6);e.optional=function(){return function(t,e,n){var s=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(t,e,n,s):o.tagProperty(t,e,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(6);e.unmanaged=function(){return function(t,e,n){var s=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(t,e,n,s)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(6);e.multiInject=function(t){return function(e,n,s){var a=new i.Metadata(r.MULTI_INJECT_TAG,t);"number"==typeof s?o.tagParameter(e,n,s,a):o.tagProperty(e,n,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(6);e.targetName=function(t){return function(e,n,s){var a=new i.Metadata(r.NAME_TAG,t);o.tagParameter(e,n,s,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(0),o=n(4);e.postConstruct=function(){return function(t,e,n){var s=new o.Metadata(i.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,t.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,s,t.constructor)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=function(t){return function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return t.bind(n).toService(e)}))}}}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(100)),r(n(45)),r(n(101))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(45);class i{constructor(t,e){this.study=t,this.dateAdded=e}static create(t){return new i(new r.Study(t),new Date)}}e.Favourite=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(46),i=n(48);e.Wishlist=class{constructor(t){this.userId=t,this._favourites=[]}get favourites(){return this._favourites}get stateHash(){const t=this._favourites.map(t=>t.study.id);return i.StateHasher.hash(t)}changeOrder(t,e){if(t===e)throw new r.WishlistException("targetStudy cannot be the same study as referenceStudy");if(!this.isFavourited(t))throw new r.WishlistException("targetStudy does not exist");let n=-1;const i=this.removeAndRetrieveFavouriteFromFavourites(t);if(e){if(!this.isFavourited(e))throw new r.WishlistException("referenceStudy does not exist");n=this.favourites.findIndex(t=>t.study.id===e)}this.favourites.splice(n+1,0,i)}removeAndRetrieveFavouriteFromFavourites(t){const e=this.favourites.findIndex(e=>e.study.id===t),n=this.favourites[e];return this.favourites.splice(e,1),n}addFavourite(t){if(this.containsStudy(t.study.id))throw new r.StudyAlreadyFavourited(this.userId,t.study.id);this._favourites.push(t)}removeFavourite(t){this.removeStudyFromFavourites(t)}containsStudy(t){return this._favourites.some(e=>e.study.id===t)}findFavourite(t){return this._favourites.find(e=>e.study.id===t)||null}removeStudyFromFavourites(t){let e=!1;if(this._favourites=this._favourites.filter(n=>{const r=n.study.id===t;return r&&(e=!0),!r}),!e)throw new r.FavouriteNotFound(this.userId,t)}toJSON(){return{userId:this.userId,favourites:this._favourites}}isFavourited(t){return this._favourites.some(e=>e.study.id===t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);class i extends r.WishlistException{constructor(){super("Favourite found without a study"),this.name="FavouriteFoundWithoutStudy"}}e.FavouriteFoundWithoutStudy=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);class i extends r.WishlistException{constructor(t,e){super(`Favourite with study id ${e} from wishlist ${t} not found.`),this.name="FavouriteNotFound"}}e.FavouriteNotFound=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);class i extends r.WishlistException{constructor(t,e){super(`Favourite with study id ${e} from wishlist ${t} already exists.`),this.wishlistId=t,this.studyId=e,this.name="StudyAlreadyFavourited"}}e.StudyAlreadyFavourited=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);class i extends r.WishlistException{constructor(t){super(`Wishlist with id ${t} not found`),this.wishlistId=t,this.name="WishlistNotFound"}}e.WishlistNotFound=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(107);e.StateHasher=class{static hash(t){return r(JSON.stringify(t)).toString()}}},function(t,e,n){var r,i,o,s,a,u,c,l;t.exports=(i=(r=l=n(108)).lib,o=i.WordArray,s=i.Hasher,a=r.algo,u=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],c=0;c<80;c++){if(c<16)u[c]=0|t[e+c];else{var l=u[c-3]^u[c-8]^u[c-14]^u[c-16];u[c]=l<<1|l>>>31}var f=(r<<5|r>>>27)+a+u[c];f+=c<20?1518500249+(i&o|~i&s):c<40?1859775393+(i^o^s):c<60?(i&o|i&s|o&s)-1894007588:(i^o^s)-899497514,a=s,s=o,o=i<<30|i>>>2,i=r,r=f}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(r+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}}),r.SHA1=s._createHelper(c),r.HmacSHA1=s._createHmacHelper(c),l.SHA1)},function(t,e,n){var r;t.exports=r=r||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),r={},i=r.lib={},o=i.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[r+o>>>2]|=s<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)e[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,r=[],i=function(e){e=e;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(e=18e3*(65535&e)+(e>>16)&r)&r;return i/=4294967296,(i+=.5)*(t.random()>.5?1:-1)}},o=0;o<e;o+=4){var a=i(4294967296*(n||t.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new s.init(r,e)}}),a=r.enc={},u=a.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new s.init(n,e/2)}},c=a.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new s.init(n,e)}},l=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},f=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,a=i/(4*o),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,c=t.min(4*u,i);if(u){for(var l=0;l<u;l+=o)this._doProcessBlock(r,l);var f=r.splice(0,u);n.sigBytes-=c}return new s.init(f,c)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(i.Hasher=f.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),r.algo={});return r}(Math)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(47);e.WishlistStateValidator=class{validate(t,e){if(t.stateHash!==e)throw new r.IncorrectWishlistState}}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(111)),r(n(121)),r(n(50))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(23);class i extends r.DomainEvent{constructor(t,e,n,r){super(n),this.userId=t,this.studyId=e,this.eventId=n,this.dateAdded=r,this.eventType=i.eventName,this.eventVersion="1.0.0"}static create(t,e,n=new Date){return new i(t,e,r.DomainEvent.generateId(),n)}}i.eventName="FavouriteAdded",e.FavouriteAdded=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(113))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(114);e.DomainEvent=class{constructor(t){this.eventId=t}static generateId(){return r()}}},function(t,e,n){var r=n(115),i=n(116);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||i(s)}},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,i=n;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JSONValidationFactory=class{fromJSON(t){return this.map(JSON.parse(t))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(119))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(120))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(49);class i extends r.JSONValidationFactory{inject(t){return this.fromJSON(t)}}e.JSONInPort=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(23);class i extends r.DomainEvent{constructor(t,e,n,r){super(n),this.userId=t,this.studyId=e,this.eventId=n,this.dateRemoved=r,this.eventType=i.eventName,this.eventVersion="1.0.0"}static create(t,e,n){return new i(t,e,r.DomainEvent.generateId(),n)}}i.eventName="FavouriteRemoved",e.FavouriteRemoved=i},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(123)),r(n(124))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RemoveFromWishlistCommand=class{constructor(t,e,n){this.userId=t,this.studyId=e,this.expectedState=n}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=n(2),a=n(12),u=n(17),c=n(52),l=n(24);let f=class extends l.BaseWishlistCommandHandler{constructor(t,e){super(t),this.wishlistRepository=t,this.eventEmitter=e}validate(t){if("number"!=typeof t.studyId)throw new c.FavouriteInvalidStudyId(t.studyId)}handle({studyId:t,userId:e,expectedState:n}){return o(this,void 0,void 0,(function*(){try{this.validate({studyId:t,userId:e,expectedState:n});const r=yield this.getWishlist(e,n);r.removeFavourite(t);const i=this.getCurrentDate();return yield this.wishlistRepository.removeFavourite(r,a.Favourite.create(t),i),yield this.emitFavouriteRemovedEvent(e,t,i),{resultingState:r.stateHash}}catch(t){if(t instanceof a.FavouriteNotFound)return{resultingState:n};throw t}}))}getCurrentDate(){return new Date}emitFavouriteRemovedEvent(t,e,n){return o(this,void 0,void 0,(function*(){yield this.eventEmitter.emit(a.FavouriteRemoved.eventName,a.FavouriteRemoved.create(t,e,n))}))}};f=r([s.injectable(),i(0,s.inject(u.DICore.WISHLIST_REPOSITORY)),i(1,s.inject(u.DICore.EVENT_EMITTER))],f),e.DefaultRemoveFromWishlistCommandHandler=f},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(126)),r(n(127)),r(n(53))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GetWishlistQuery=class{constructor(t){this.userId=t}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=n(2),a=n(51),u=n(53);let c=class{constructor(t){this.wishlistRepository=t}handle({userId:t}){return o(this,void 0,void 0,(function*(){let e=yield this.wishlistRepository.retrieveByUserId(t);return null===e&&(e=yield this.wishlistRepository.createWishlist(t)),new u.GetWishlistQueryResult(e)}))}};c=r([s.injectable(),i(0,s.inject(a.DICore.WISHLIST_REPOSITORY))],c),e.DefaultGetWishlistQueryHandler=c},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(129)),r(n(130))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SetWishlistOrderCommand=class{constructor(t,e,n,r){this.userId=t,this.targetStudyId=e,this.position=n,this.expectedState=r}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=n(2),a=n(12),u=n(50),c=n(17),l=n(24);let f=class extends l.BaseWishlistCommandHandler{constructor(t,e){super(t),this.wishlistRepository=t,this.eventEmitter=e}handle({userId:t,targetStudyId:e,position:n,expectedState:r}){return o(this,void 0,void 0,(function*(){const i=yield this.getWishlist(t,r);let o=null;if(0!==n){if(!i.favourites[n])throw new a.WishlistException("Position out of bounds");o=i.favourites[n].study.id}return i.changeOrder(e,o),yield this.wishlistRepository.setWishlistOrder(i,e,o),yield this.emitWishListOrderChangedEvent(t,e,o,new Date),{resultingState:i.stateHash}}))}emitWishListOrderChangedEvent(t,e,n,r){return o(this,void 0,void 0,(function*(){yield this.eventEmitter.emit(u.WishlistOrderChanged.eventName,u.WishlistOrderChanged.create(t,e,n,r))}))}};f=r([s.injectable(),i(0,s.inject(c.DICore.WISHLIST_REPOSITORY)),i(1,s.inject(c.DICore.EVENT_EMITTER))],f),e.SetWishlistOrderCommandHandler=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(132))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommandResult=class{constructor(t){this.resultingState=t}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),c=n(2),l=n(13),f=n(34),h=n(35),d=n(19),p=n(36),y=n(26),v=n(14),g=n(59),b=function(){function t(t,e,n,r){this.sessionService=t,this.baseUrl=e,this.wishlistCache=n,this.tracker=r}return Object.defineProperty(t.prototype,"fetch",{get:function(){return l.default},enumerable:!0,configurable:!0}),t.prototype.addFavourite=function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,this.getWishlist()];case 1:return e=n.sent(),[4,this.executeRequest("","POST",{studyId:t,expectedState:e.stateHash})];case 2:return n.sent(),[2]}}))}))},t.prototype.getWishlist=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,this.wishlistCache.getWishlist()];case 1:return null!==(t=e.sent())?[3,4]:[4,this.retrieveWishlistFromApi()];case 2:return t=e.sent(),[4,this.wishlistCache.setWishlist(t)];case 3:e.sent(),e.label=4;case 4:return[2,t]}}))}))},t.prototype.removeFavourite=function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,this.getWishlist()];case 1:return e=n.sent(),[4,this.executeRequest("","DELETE",{studyId:t,expectedState:e.stateHash})];case 2:return n.sent(),[2]}}))}))},t.prototype.setOrder=function(t,e){return s(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return[4,this.getWishlist()];case 1:return n=r.sent(),[4,this.executeRequest("/order","PATCH",{targetStudyId:t,position:e,expectedState:n.stateHash})];case 2:return r.sent(),[2]}}))}))},t.prototype.retrieveWishlistFromApi=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,this.executeRequest("")];case 1:return t=e.sent().wishlist,[2,y.WishlistFactory.translateSerializedWishlist(t)]}}))}))},t.prototype.getRequestOptions=function(t,e){return s(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(o){switch(o.label){case 0:return r={},i={},[4,this.getAuthorizationToken()];case 1:return r.headers=(i.Authorization=o.sent(),i),r.method=t,n=r,null!==e&&(n.body=JSON.stringify(e)),[2,n]}}))}))},t.prototype.executeRequest=function(t,e,n){return void 0===e&&(e="GET"),void 0===n&&(n=null),s(this,void 0,void 0,(function(){var r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),[4,this.getRequestOptions(e,n)];case 1:return r=a.sent(),[4,this.fetch(this.getFullUrl(t),r)];case 2:return[4,(i=a.sent()).json()];case 3:return o=a.sent(),i.ok&&!o.failed?[3,5]:[4,this.handleError(o)];case 4:throw a.sent();case 5:return[2,o];case 6:throw(s=a.sent())instanceof u.WishlistException||(s=new Error("An unknown issue encountered while contacting our wishlist service")),s;case 7:return[2]}}))}))},t.prototype.getFullUrl=function(t){return""+this.baseUrl+t},t.prototype.getAuthorizationToken=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.sessionService.getSession()];case 1:return[2,t.sent().getAccessToken()]}}))}))},t.prototype.handleIncorrectWishlistStateException=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.wishlistCache.clearCache()];case 1:return t.sent(),[2,new u.IncorrectWishlistState]}}))}))},t.prototype.handleWishlistNotFoundException=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.wishlistCache.clearCache()];case 1:return e.sent(),[2,new u.WishlistNotFound(t.wishlistId)]}}))}))},t.prototype.handleDefaultException=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,o,s,c,l;return a(this,(function(a){switch(a.label){case 0:return void 0===t.message||"Unauthorized"!==t.message?[3,3]:[4,window.SessionService.getSession()];case 1:return e=a.sent(),n=e.getUser(),i=(r=this.tracker).track,o={action:f.default.General,label:h.default.JWTAuthError,tags:[p.default.Error]},c=(s=JSON).stringify,l={identityId:n.identityId},[4,e.getAccessToken()];case 2:i.apply(r,[(o.eventData=c.apply(s,[(l.token=a.sent(),l.time=Date.now(),l.localTime=(new Date).toLocaleString(),l.needsToRefresh=e.shouldRefresh(),l)]),o)]),a.label=3;case 3:return[2,new u.WishlistException("An unknown issue encountered while contacting our wishlist service")]}}))}))},t.prototype.handleError=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(t.name){case"IncorrectWishlistState":return[2,this.handleIncorrectWishlistStateException()];case"WishlistNotFound":return[2,this.handleWishlistNotFoundException(t)];default:return[2,this.handleDefaultException(t)]}return[2]}))}))},r([c.injectable(),o(0,c.inject(v.DI.SESSION_SERVICE)),o(1,c.inject(v.DI.WISHLIST_BASEURL)),o(2,c.inject(v.DI.WISHLIST_CACHE)),o(3,c.inject(v.DI.TRACKER)),i("design:paramtypes",[Object,String,g.WishlistCache,d.default])],t)}();e.DecisionMakingApiWishlistService=b},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(135),e),i(n(55),e),i(n(56),e),i(n(136),e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PremiumLinkService=void 0;var r=n(137),i=n(138),o=n(141),s=n(57),a=n(142),u=function(){function t(t){this.programmeData=new r.ProgrammeData(t),this.programmePremium=new i.ProgrammePremium(this.programmeData,new o.StaticPremiumVariants(s.PremiumVariantType.VARIANT_DEFAULT)),this.trackedLinkFactory=new a.TrackedLinkFactory(this.programmeData,this.programmePremium)}return t.prototype.getPremiumLink=function(t){return this.programmePremium.mayShowWebsiteLink()?this.trackedLinkFactory.buildTrackedLink(this.programmeData.getHomepageLink(),t):null},t}();e.PremiumLinkService=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProgrammeData=void 0;var r=function(){function t(t){this.data=t}return t.prototype.getId=function(){return Number(this.data.id)},t.prototype.getFirstElementOrNull=function(t){var e=this.data[t];for(var n in e)return e[n];return null},t.prototype.getPremiumsOutOfRange=function(){return this.data.premiums_out_of_range},t.prototype.getPremiumsOutOfDate=function(){return this.data.premiums_out_of_date},t.prototype.getPremiums=function(){return this.data.premiums},t.prototype.getCpm=function(){return Number(this.data.cpm)},t.prototype.getCommercialRange=function(){return this.data.commercial_range},t.prototype.getHomepageLink=function(){return this.getFirstElementOrNull("link_homepage")},t}();e.ProgrammeData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProgrammePremium=void 0;var r=n(57),i=n(139),o=n(140),s=function(){function t(t,e){this.programmeData=t,this.premiumVariants=e,this.type=this.resolvePremiumType(t);var n=e.getVariant();n!==r.PremiumVariantType.VARIANT_OUT_OF_RANGE?n!==r.PremiumVariantType.VARIANT_OUT_OF_DATE?this.premiums=t.getPremiums():this.premiums=t.getPremiumsOutOfDate():this.premiums=t.getPremiumsOutOfRange()}return t.prototype.resolvePremiumType=function(t){var e=t.getCpm();if(0===e)return o.ProgrammePremiumType.BASIC;if(5e3===e)return o.ProgrammePremiumType.SUPER_PREMIUM;if(2500===e)return o.ProgrammePremiumType.PREMIUM;if(1e3===e)return o.ProgrammePremiumType.LIGHT;var n=t.getCommercialRange();return 50==n[1]-n[0]+1?o.ProgrammePremiumType.SUPER_LIGHT:o.ProgrammePremiumType.SUPER_SUPER_LIGHT},t.prototype.mayShowWebsiteLink=function(){return this.premiums.includes(i.ProgrammePremiumFeatureType.PREMIUM_LINKS)},t.prototype.getPremiumType=function(){return this.type},t}();e.ProgrammePremium=s},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.ProgrammePremiumFeatureType=void 0,(r=e.ProgrammePremiumFeatureType||(e.ProgrammePremiumFeatureType={})).PREMIUM_DISPLAY_PREMIUM="display_premium",r.PREMIUM_DISPLAY_REGULAR="display_regular",r.PREMIUM_LOGO="logo",r.PREMIUM_LINKS="links_website",r.PREMIUM_GALLERY="gallery",r.PREMIUM_HIDE_BANNERS="hide_banners"},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.ProgrammePremiumType=void 0,(r=e.ProgrammePremiumType||(e.ProgrammePremiumType={})).SUPER_PREMIUM="sp",r.PREMIUM="p",r.LIGHT="l",r.SUPER_LIGHT="sl",r.SUPER_SUPER_LIGHT="ssl",r.BASIC="b"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StaticPremiumVariants=void 0;var r=function(){function t(t){this.variation=t}return t.prototype.getVariant=function(){return this.variation},t}();e.StaticPremiumVariants=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TrackedLinkFactory=void 0;var r=n(55),i=n(56),o=function(){function t(t,e){this.programmeData=t,this.programmePremium=e}return t.prototype.buildTrackedLink=function(t,e){return t?new r.TrackedLink(this.getTrackingForLink(t,e),this.getExternalUrl(t.url),t.description):null},t.prototype.getTrackingForLink=function(t,e){var n={category:"Study",action:this.getGaAction(),label:this.programmeData.getId().toString(),value:e},r={pt:this.programmePremium.getPremiumType()};return new i.Tracking(JSON.stringify(n),"clic","link",t.id,t.url,this.getLabel(),JSON.stringify(r))},t.prototype.getExternalUrl=function(t){return"track/click/?target="+encodeURIComponent(t)},t.prototype.getGaAction=function(){return"Premium Click"},t.prototype.getLabel=function(){return"revenue"},t}();e.TrackedLinkFactory=o},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),c=n(2),l=n(14),f=function(){function t(t,e,n,r){this.addToWishlistCommandHandler=t,this.getWishlistQueryHandler=e,this.removeFromWishlistCommandHandler=n,this.setWishlistOrderCommandHandler=r,this.userId="local-wishlist"}return t.prototype.addFavourite=function(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,this.getWishlist()];case 1:return e=r.sent(),n=this.createAddToWishlistCommand(t,e),[4,this.addToWishlistCommandHandler.handle(n)];case 2:return r.sent(),[2]}}))}))},t.prototype.getWishlist=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=this.createGetWishlistQuery(),[4,this.getWishlistQueryHandler.handle(t)];case 1:return[2,e.sent().wishlist]}}))}))},t.prototype.removeFavourite=function(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,this.getWishlist()];case 1:return e=r.sent(),n=this.createRemoveFromWishlistCommand(t,e),[4,this.removeFromWishlistCommandHandler.handle(n)];case 2:return r.sent(),[2]}}))}))},t.prototype.setOrder=function(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:return[4,this.getWishlist()];case 1:return n=i.sent(),r=this.createSetWishlistOrderCommand(t,e,n),[4,this.setWishlistOrderCommandHandler.handle(r)];case 2:return i.sent(),[2]}}))}))},t.prototype.createGetWishlistQuery=function(){return new u.GetWishlistQuery(this.userId)},t.prototype.createAddToWishlistCommand=function(t,e){return new u.AddToWishlistCommand(this.userId,t,e.stateHash)},t.prototype.createRemoveFromWishlistCommand=function(t,e){return new u.RemoveFromWishlistCommand(this.userId,t,e.stateHash)},t.prototype.createSetWishlistOrderCommand=function(t,e,n){return new u.SetWishlistOrderCommand(this.userId,t,e,n.stateHash)},r([c.injectable(),o(0,c.inject(l.DI.ADD_TO_WISHLIST_COMMAND_HANDLER)),o(1,c.inject(l.DI.GET_WISHLIST_COMMAND_HANDLER)),o(2,c.inject(l.DI.REMOVE_FROM_WISHLIST_COMMAND_HANDLER)),o(3,c.inject(l.DI.SET_WISHLIST_ORDER_COMMAND_HANDLER)),i("design:paramtypes",[Object,Object,Object,Object])],t)}();e.LocalWishlistService=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(145),i=function(){function t(){this.queue=new r(1,1/0)}return t.prototype.setWishlistService=function(t){this.wishlistService=t},t.prototype.getWishlist=function(){var t=this;return this.queue.add((function(){return t.wishlistService.getWishlist()}))},t.prototype.addFavourite=function(t){var e=this;return this.queue.add((function(){return e.wishlistService.addFavourite(t)}))},t.prototype.removeFavourite=function(t){var e=this;return this.queue.add((function(){return e.wishlistService.removeFavourite(t)}))},t.prototype.setOrder=function(t,e){var n=this;return this.queue.add((function(){return n.wishlistService.setOrder(t,e)}))},t}();e.QueueWishlistService=i},function(t,e,n){t.exports=Object({NODE_ENV:"production"}).PROMISE_QUEUE_COVERAGE?n(146):n(147)},function(t,e){},function(t,e,n){var r,i;!function(o,s){"use strict";t.exports?t.exports=s():void 0===(i="function"==typeof(r=s)?r.call(e,n,e,t):r)||(t.exports=i)}(0,(function(){"use strict";var t="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw new Error("Queue.configure() before use Queue")}}},e=function(){};function n(t,e,n){this.options=n=n||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==t?t:1/0,this.maxQueuedPromises=void 0!==e?e:1/0,this.queue=[]}return n.configure=function(e){t=e},n.prototype.add=function(n){var r=this;return new t((function(t,i,o){r.queue.length>=r.maxQueuedPromises?i(new Error("Queue limit reached")):(r.queue.push({promiseGenerator:n,resolve:t,reject:i,notify:o||e}),r._dequeue())}))},n.prototype.getPendingLength=function(){return this.pendingPromises},n.prototype.getQueueLength=function(){return this.queue.length},n.prototype._dequeue=function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var n,r=this.queue.shift();if(!r)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,(n=r.promiseGenerator(),n&&"function"==typeof n.then?n:new t((function(t){t(n)}))).then((function(t){e.pendingPromises--,r.resolve(t),e._dequeue()}),(function(t){e.pendingPromises--,r.reject(t),e._dequeue()}),(function(t){r.notify(t)}))}catch(t){e.pendingPromises--,r.reject(t),e._dequeue()}return!0},n}))},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),u=n(2),c=function(){function t(t){this.wishlistService=t}return t.prototype.addFavourite=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.wishlistService.addFavourite(t)];case 1:return n.sent(),[3,3];case 2:if((e=n.sent())instanceof a.IncorrectWishlistState||e instanceof a.WishlistNotFound)return[2,this.wishlistService.addFavourite(t)];throw e;case 3:return[2]}}))}))},t.prototype.removeFavourite=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.wishlistService.removeFavourite(t)];case 1:return n.sent(),[3,3];case 2:if((e=n.sent())instanceof a.IncorrectWishlistState)return[2,this.wishlistService.removeFavourite(t)];throw e;case 3:return[2]}}))}))},t.prototype.getWishlist=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.wishlistService.getWishlist()]}))}))},t.prototype.setOrder=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.wishlistService.setOrder(t,e)]}))}))},r([u.injectable(),i("design:paramtypes",[Object])],t)}();e.RetryCommandWishlistService=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(150),o=function(){function t(t,e){this.eventAggregationService=t,this.wishlistCache=e}return t.prototype.initialize=function(){this.eventAggregationService.subscribeToWebSocketEvent(r.FavouriteAdded.eventName,new i.WebSocketFavouriteAddedSubscriber(this.eventAggregationService,this.wishlistCache))},t}();e.WebSocketFavouriteAddedAdapter=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),s=function(){function t(t,e){this.eventAggregationService=t,this.wishlistCache=e}return t.prototype.notify=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.wishlistCache.clearCache()];case 1:return e.sent(),this.eventAggregationService.publishFavouriteAddedEvent(new o.FavouriteAdded(t.userId,t.studyId,t.eventId,new Date(t.dateAdded))),[2]}}))}))},t}();e.WebSocketFavouriteAddedSubscriber=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(152),o=function(){function t(t,e){this.eventAggregationService=t,this.wishlistCache=e}return t.prototype.initialize=function(){this.eventAggregationService.subscribeToWebSocketEvent(r.FavouriteRemoved.eventName,new i.WebSocketFavouriteRemovedSubscriber(this.eventAggregationService,this.wishlistCache))},t}();e.WebSocketFavouriteRemovedAdapter=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),s=function(){function t(t,e){this.eventAggregationService=t,this.wishlistCache=e}return t.prototype.notify=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.removeFavouriteToCachedWishlist(t)];case 1:return e.sent(),this.eventAggregationService.publishFavouriteRemovedEvent(new o.FavouriteRemoved(t.userId,t.studyId,t.eventId,new Date(t.dateRemoved))),[2]}}))}))},t.prototype.removeFavouriteToCachedWishlist=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this.wishlistCache.getWishlist()];case 1:return(e=n.sent())?(e.removeFavourite(t.studyId),[4,this.wishlistCache.setWishlist(e)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t}();e.WebSocketFavouriteRemovedSubscriber=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(154),o=function(){function t(t,e){this.eventAggregationService=t,this.wishlistCache=e}return t.prototype.initialize=function(){this.eventAggregationService.subscribeToWebSocketEvent(r.WishlistOrderChanged.eventName,new i.WebsocketWishlistOrderChangedSubscriber(this.eventAggregationService,this.wishlistCache))},t}();e.WebsocketWishlistOrderChangedAdapter=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),s=function(){function t(t,e){this.eventAggregationService=t,this.wishlistCache=e}return t.prototype.notify=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.setOrderOnCachedWishlist(t)];case 1:return e.sent(),this.eventAggregationService.publishWishlistOrderChangedEvent(new o.WishlistOrderChanged(t.userId,t.targetStudyId,t.referenceStudyId,t.eventId,new Date(t.dateChanged))),[2]}}))}))},t.prototype.setOrderOnCachedWishlist=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this.wishlistCache.getWishlist()];case 1:return(e=n.sent())?(e.changeOrder(t.targetStudyId,t.referenceStudyId),[4,this.wishlistCache.setWishlist(e)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t}();e.WebsocketWishlistOrderChangedSubscriber=s},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),c=n(2),l=n(37),f=n(58),h=function(){function t(t){this.eventAggregationService=t}return t.prototype.emit=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:switch(e.constructor){case u.FavouriteAdded:return[3,1];case u.FavouriteRemoved:return[3,3];case u.WishlistOrderChanged:return[3,5]}return[3,7];case 1:return[4,this.eventAggregationService.publishFavouriteAddedEvent(e)];case 2:return t.sent(),[3,8];case 3:return[4,this.eventAggregationService.publishFavouriteRemovedEvent(e)];case 4:return t.sent(),[3,8];case 5:return[4,this.eventAggregationService.publishWishlistOrderChangedEvent(e)];case 6:return t.sent(),[3,8];case 7:t.label=8;case 8:return[2]}}))}))},r([c.injectable(),o(0,c.inject(f.DI.EVENT_AGGREGATION_SERVICE)),i("design:paramtypes",[l.EventAggregationService])],t)}();e.EventAggregationServiceEventEmitter=h},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),c=n(2),l=n(14),f=n(26),h=function(){function t(t){this.localStorageDriver=t,this.localStorageKey="local-wishlist"}return t.prototype.addFavourite=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.saveWishlist(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.removeFavourite=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.saveWishlist(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.setWishlistOrder=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.saveWishlist(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.retrieveByUserId=function(t){return s(this,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return[4,this.localStorageDriver.get(this.localStorageKey)];case 1:return""===(t=n.sent())||null===t||null===(e=JSON.parse(t))||void 0===e.userId?[2,null]:[2,f.WishlistFactory.translateSerializedWishlist(e)]}}))}))},t.prototype.changeUserId=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(t){throw new Error("Not available on local wishlist")}))}))},t.prototype.createWishlist=function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=new u.Wishlist(t),[4,this.saveWishlist(e)];case 1:return n.sent(),[2,e]}}))}))},t.prototype.removeWishlist=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.localStorageDriver.remove(this.localStorageKey)];case 1:return t.sent(),[2]}}))}))},t.prototype.saveWishlist=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.localStorageDriver.set(this.localStorageKey,JSON.stringify(t),1e12)];case 1:return e.sent(),[2]}}))}))},r([c.injectable(),o(0,c.inject(l.DI.LOCALSTORAGE_DRIVER)),i("design:paramtypes",[Object])],t)}();e.LocalWishlistRepository=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7),i=n(13),o=n(158),s=n(159),a=n(161),u=n(163);window.Student=new u.Student(new a.StudentapiDriver(r.default.studentApiBaseUrl,window.AuthController,i.default,o.default),new s.ServicelayerDriver(r.default.serviceLayerBaseUrl,window.AuthController,i.default,o.default),o.default)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(28),i=n(19),o=n(7),s={environment:o.default.stage?o.default.stage:"dev",team:"xm",product:"StudentJS",category:"Profile"},a=new i.default(s);e.default=function(t,e){if(void 0===e&&(e={}),function(t){void 0===t.action&&(t.action=r.Actions.General),void 0===t.label&&(t.label=r.Labels.JSError),void 0===t.tags&&(t.tags=[r.Tags.Error])}(e),t){if(t instanceof Error){var n=t.name,i=t.message,o=t.stack;e.eventData=JSON.stringify({name:n,message:i,stack:o})}else e.eventData="object"==typeof t?JSON.stringify(t):"string"==typeof t?t:t.toString();e.payload&&(e.payload=JSON.stringify(e.payload),e.eventData.toLowerCase().includes("password")||e.payload.toLowerCase().includes("password")||(e.eventData+=e.payload),delete e.payload)}throw a.track(e),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(28),i=n(160),o=n(20),s=function(){function t(t,e,n,r){this.retrievingFavourites=null,this.baseUrl=t,this.authController=e,this.fetch=n,this.countries={},this.disciplines={},this.studies={},this.organisations={},this.trackError=r}return t.prototype.clearCache=function(t){void 0===t&&(t="");var e=!0;switch(t){case"countries":this.countries={};break;case"disciplines":this.disciplines={};break;case"interests":this.countries={},this.disciplines={};break;default:e=!1}return e},t.prototype.addResourceType=function(t,e){return e.map((function(e){return e.type=t,e}))},t.prototype.getDisciplines=function(t){return this.getResources("disciplines",t)},t.prototype.getInterests=function(t,e){return t=t===i.InterestType.Country?"countries":"disciplines",this.getResources(t,e)},t.prototype.getResources=function(t,e){var n=this,r=this.getResourceCacheState(t,e),i=r.cached,s=r.notCached;return 0===s.length?Promise.resolve(this.mergeResourcesFromCacheWithNew(t,i,[])):this.sendRequest(o.RestCallType.GET,"/"+t+"?ids="+s.join(",")).then((function(e){return Array.isArray(e)?(e.forEach((function(e){n[t][e.id]=e})),n.mergeResourcesFromCacheWithNew(t,i,e)):[]}))},t.prototype.getResourceCacheState=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){n.isResourceInCache(t,e)?r.push(e):i.push(e)})),{cached:r,notCached:i}},t.prototype.mergeResourcesFromCacheWithNew=function(t,e,n){var r=this,i=[];return e.forEach((function(e){i.push(r[t][e.toString()])})),i=i.concat(n)},t.prototype.isResourceInCache=function(t,e){return void 0!==Object.keys(this[t]).find((function(t){return t===e.toString()}))},t.prototype.sendRequest=function(t,e,n){var i=this;return void 0===n&&(n=null),this.authController.getAccessToken().then((function(s){var a={method:t};return a.headers={"Content-Type":"application/json",Authorization:s},a.credentials="omit",t.toUpperCase()!==o.RestCallType.GET&&n&&(a.body=JSON.stringify(n)),i.fetch(i.baseUrl+e,a).then((function(t){return t.json()})).catch((function(t){return i.trackError(t,{action:r.Actions.SLRequest,label:r.Labels.SLError})}))})).catch((function(t){return i.trackError(t,{action:r.Actions.JWTAuth,label:r.Labels.JWTAuthError})}))},t}();e.ServicelayerDriver=s},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.InterestType||(e.InterestType={})).Country="country",r.Discipline="discipline"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(28),i=n(162),o=n(20),s=function(){function t(t,e,n,r){this.baseUrl=t,this.authController=e,this.fetch=n,this.trackError=r}return t.prototype.getInterests=function(e){var n=t.getInterestFieldName(e);return this.sendRequest(o.RestCallType.GET,"/data?scope="+n,{}).then((function(t){return null==t[n]?[]:t[n]}))},t.prototype.addInterests=function(e,n){var r=t.getInterestFieldName(e),i={};return i[r+"_add"]=n,this.sendRequest(o.RestCallType.PATCH,"/data",i).then((function(t){return t[r]}))},t.prototype.removeInterests=function(e,n){var r=t.getInterestFieldName(e),i={};return i[r+"_remove"]=n,this.sendRequest(o.RestCallType.PATCH,"/data",i).then((function(t){return t[r]}))},t.prototype.removeDisciplines=function(t){var e={disciplines_remove:t};return this.sendRequest(o.RestCallType.PATCH,"/data",e).then((function(t){return t.disciplines}))},t.prototype.addDisciplines=function(t){var e={disciplines_add:t};return this.sendRequest(o.RestCallType.PATCH,"/data",e).then((function(t){return t.disciplines}))},t.prototype.getDisciplines=function(){return this.sendRequest(o.RestCallType.GET,"/data?scope=disciplines",{}).then((function(t){return null==t.disciplines?[]:t.disciplines}))},t.prototype.sendRequest=function(t,e,n){var s=this;return this.authController.getAccessToken().then((function(i){var a={method:t,headers:{"Content-Type":"application/json",Authorization:i}};t.toUpperCase()!==o.RestCallType.GET&&n&&(a.body=JSON.stringify(n));var u=!1,c=s.baseUrl+e,l={action:r.Actions.StudentsAPIRequest,label:r.Labels.StudentsAPIError,payload:{fetchUrl:c,options:a}};return s.fetch(c,a).then((function(t){return u=t.ok,t.json()})).then((function(t){return u||s.trackError(t,l),t})).catch((function(t){return s.trackError(t,l)}))})).catch((function(t){throw t instanceof i.default&&s.trackError(t,{action:r.Actions.JWTAuth,label:r.Labels.JWTAuthError}),t}))},t.prototype.patchData=function(t){return this.sendRequest(o.RestCallType.PATCH,"/data",t)},t.prototype.getData=function(t){return this.sendRequest(o.RestCallType.GET,"/data?scope="+t,{})},t.prototype.confirmForgotPassword=function(t,e){var n=this;return this.authController.getEmail().then((function(r){return n.sendRequest(o.RestCallType.PATCH,"/forgot-password",{ConfirmationCode:t,Password:e,Username:r})}))},t.prototype.disableAccount=function(){return this.sendRequest(o.RestCallType.DELETE,"/disable-account",{})},t.prototype.changePassword=function(t,e,n){return this.sendRequest(o.RestCallType.PATCH,"/change-password",{oldPassword:t,password:e,passwordConfirmation:n})},t.getInterestFieldName=function(t){if("country"===t)return"interests_countries";if("discipline"===t)return"interests_disciplines";throw new Error("Invalid interest type only country and discipline supported")},t}();e.StudentapiDriver=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){this.message=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(164),i=n(165),o=n(166),s=n(167),a=n(168),u=function(){function t(t,e,n){this.studentAPI=t,this.serviceLayer=e,this.readyCallbacks=[],this.interests={},this.readyFlag=!1,this.trackError=n}return t.prototype.ready=function(t){this.readyCallbacks.push(t),this.readyFlag&&this.notifyReadyCallbacks()},t.prototype.notifyReadyCallbacks=function(){this.readyCallbacks.shift()(this)},t.prototype.clearCache=function(){this.clearInterestsCache()},t}();e.Student=u,r.applyMixins(u,[a.Interests,o.Data,s.Disciplines,i.Account])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.applyMixins=function(t,e){e.forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(n){t.prototype[n]=e.prototype[n]}))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.confirmForgotPassword=function(t,e){return this.studentAPI.confirmForgotPassword(t,e)},t.prototype.disableAccount=function(){return this.studentAPI.disableAccount()},t.prototype.changePassword=function(t,e,n){return this.studentAPI.changePassword(t,e,n)},t}();e.Account=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.getScope=function(t){return this.studentAPI.getData(t)},t.prototype.getScopes=function(t){return this.getScope(t.join(","))},t.prototype.setValue=function(t,e){var n={};return n[t]=e,this.studentAPI.patchData(n)},t.prototype.setValues=function(t){return this.studentAPI.patchData(t)},t.prototype.setGPA=function(t,e){var n,r={gpa:(n={},n[t]=e,n.current_type=t,n)};return this.studentAPI.patchData(r)},t.prototype.setName=function(t){var e,n,r=t.indexOf(" ",0);-1!==r?(e=t.substring(0,r),n=t.substring(r).trim()):(e=t,n=null);var i={name:t,first_name:e,last_name:n};return this.studentAPI.patchData(i)},t}();e.Data=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.addDisciplines=function(t){var e=this;return this.studentAPI.addDisciplines(t).then((function(t){return e.disciplines=t,t}))},t.prototype.removeDisciplines=function(t){var e=this;return this.studentAPI.removeDisciplines(t).then((function(t){return e.disciplines=t,e.disciplines}))},t.prototype.getDisciplines=function(){var t=this;return new Promise((function(e,n){if(void 0===t.disciplines||!Array.isArray(t.disciplines))return t.studentAPI.getDisciplines().then((function(n){t.disciplines=null===n?[]:n,e(t.disciplines)}));e(t.disciplines)}))},t.prototype.getDisciplinesData=function(t){var e=this;return this.getDisciplines().then((function(t){return Array.isArray(t)&&t.length>0?e.serviceLayer.getDisciplines(t):[]}))},t}();e.Disciplines=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.clearInterestsCache=function(){this.interests={},this.serviceLayer.clearCache("interests")},t.prototype.addInterests=function(t,e){var n=this;return this.studentAPI.addInterests(t,e).then((function(e){return n.interests[t]=e,e}))},t.prototype.removeInterests=function(t,e){var n=this;return this.studentAPI.removeInterests(t,e).then((function(e){return n.interests[t]=e,e}))},t.prototype.getInterestsData=function(t){var e=this;return this.getInterests(t).then((function(n){return Array.isArray(n)&&n.length>0?e.serviceLayer.getInterests(t,n):[]}))},t.prototype.getInterests=function(t){var e=this;return new Promise((function(n,r){return void 0===e.interests[t]?e.studentAPI.getInterests(t).then((function(r){return Array.isArray(r)&&r.length>0?(e.interests[t]=r,n(r)):(e.interests[t]=[],n([]))})):n(e.interests[t])}))},t}();e.Interests=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this;Object.defineProperty(e,"__esModule",{value:!0});var s=n(7),a=n(13),u=n(10),c=n(37),l=n(170),f=n(171),h=n(174),d=n(175),p=n(176),y=n(186),v=n(191),g=n(193),b=n(16),w=n(194),_=new l.WebSocketGateway(""+s.default.wssEndpoint),m=new c.EventAggregationService(_),S=new w.TokenService(s.default.tokenServiceBaseUrl),E=new p.TokenBasedSessionFactory(m,S),T=new y.TokenBasedSessionRepositoryFactory(m,E,s.default).createByBrowserNavigator(navigator),A=new v.TokenBasedSessionService(T,m,S),O=new h.StudentapiDriver(s.default.studentApiBaseUrl,a.default),R=new f.default(A,O,m,new d.BrowserSessionStorage),I=new Date;function P(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=E.create(t),[4,A.setSession(e)];case 1:return n.sent(),[2]}}))}))}function C(){var t=new URL(window.location).searchParams.get("refreshToken");null!==t&&P(new b.Credentials(null,t))}_.EventAggregationService=m,window.AuthController=R,window.EventAggregationService=m,window.SessionService=A,window.SessionFactory=E,m.subscribeToSessionServiceReadyEvent(new u.CallbackSubscriber((function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){return"complete"===document.readyState?C():document.addEventListener("readystatechange",(function(t){"complete"===t.target.readyState&&C()})),_.initialize(t),[2]}))}))})));var x=null;function k(){null!==x&&window.snowplow("trackStructEvent","SessionService","initializing","completed",null,x.getTime()-I.getTime())}m.subscribeToSessionServiceReadyEvent(new u.CallbackSubscriber((function(){if(void 0===window.snowplow)return null;x=new Date,window.snowplow((function(){Object.keys(this).join("|").includes("cf7_")&&k(),document.addEventListener("DataTrackerReady",(function(){k()}))}))}))),document.addEventListener("student_logged_in",(function(t){P(t.detail)})),window.addEventListener("storage",(function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:if("SessionService/credentials"!==t.key)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),e=JSON.parse(t.newValue),n=JSON.parse(e.data),[4,A.getSession()];case 2:return null!==r.sent()?[2]:(P(n),[3,4]);case 3:return r.sent(),[3,4];case 4:return[2]}}))}))})),R.subscribe((function(t,e){return r(o,void 0,void 0,(function(){var t,n,r;return i(this,(function(i){switch(i.label){case 0:return!0!==e.LoggedInStatus||void 0===window.ga?[3,2]:(n=(t=window).ga,r=["set","userId"],[4,R.getIdentityId()]);case 1:n.apply(t,r.concat([i.sent()])),i.label=2;case 2:return[2]}}))}))})),m.subscribeToSessionServiceReadyEvent(new g.RollbarIdentitySubscriber(m)),R.initialize(),A.initialize(),T.initialize()},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),s=function(){function t(t){this.wssEndpoint=t,this.subscribers=[]}return Object.defineProperty(t.prototype,"EventAggregationService",{set:function(t){this.eventAggregationService=t},enumerable:!0,configurable:!0}),t.prototype.initialize=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.sessionService=t,[4,this.isUserLoggedIn()];case 1:return e.sent()?[4,this.connect()]:[3,3];case 2:e.sent(),e.label=3;case 3:return this.addEventAggregationEventListeners(),[2]}}))}))},t.prototype.connect=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return[4,this.getAccessToken()];case 1:return t=n.sent(),e=window.location&&window.location.href?encodeURIComponent(window.location.href):"",this.socket=new WebSocket(this.wssEndpoint+"?token="+t+"&url="+e),this.addWebsocketEventListeners(),[2]}}))}))},t.prototype.addSubscriber=function(t){this.subscribers.push(t)},t.prototype.isUserLoggedIn=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.sessionService.getSession()];case 1:return[2,null!==t.sent()]}}))}))},t.prototype.addEventAggregationEventListeners=function(){var t=this;this.eventAggregationService.subscribeToSessionCreatedEvent(new o.CallbackSubscriber((function(){return t.connect()})))},t.prototype.addWebsocketEventListeners=function(){var t=this;this.socket.addEventListener("message",(function(e){t.onMessage(JSON.parse(e.data))})),this.socket.addEventListener("close",(function(){t.reconnect()}))},t.prototype.reconnect=function(){var t=this;setTimeout((function(){return t.connect()}),5e3)},t.prototype.getAccessToken=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.sessionService.getSession()];case 1:return[2,t.sent().getAccessToken()]}}))}))},t.prototype.onMessage=function(t){this.subscribers.filter((function(e){return e.canHandle(t.eventType)})).forEach((function(e){return e.handle(t)}))},t}();e.WebSocketGateway=s},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(10),u=n(15),c=n(172),l=n(29),f=n(173),h=function(){function t(t,e,n,r){this.browserSessionStorageKey="LoggedInStatus",this.isLoggedInStatus=!1,this.sessionService=t,this.studentApiDriver=e,this.eventAggregationService=n,this.browserSessionStorage=r,this.deferred=new l.Deferred,this.subscribers=[]}return t.prototype.initialize=function(){var t=this;this.eventAggregationService.subscribeToSessionServiceReadyEvent(new a.CallbackSubscriber((function(){return t.onSessionServiceReady()}))),this.eventAggregationService.subscribeToSessionCreatedEvent(new a.CallbackSubscriber((function(){return t.onSessionCreated()}))),this.eventAggregationService.subscribeToSessionDestroyedEvent(new a.CallbackSubscriber((function(){return t.onSessionDestroyed()})))},t.prototype.onSessionServiceReady=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.sessionService.getSession()];case 1:return t=e.sent(),this.setLoginStatus(null!==t),this.deferred.open(),[2]}}))}))},t.prototype.onSessionCreated=function(){this.setLoginStatus(!0),this.notifySubscribers()},t.prototype.onSessionDestroyed=function(){this.setLoginStatus(!1),this.notifySubscribers()},t.prototype.notifySubscribers=function(){var t=this;this.subscribers.forEach((function(e){e.notify(null,{LoggedInStatus:t.isLoggedInStatus})}))},t.prototype.subscribe=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,this.deferred.untilOpen()];case 1:return n.sent(),(e=new c.CallbackSubscriberLegacy(t)).notify(null,{LoggedInStatus:this.isLoggedInStatus}),this.subscribers.push(e),[2]}}))}))},t.prototype.getTokenSession=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.deferred.untilOpen()];case 1:return e.sent(),[4,this.sessionService.getSession()];case 2:if(null===(t=e.sent()))throw new f.default("No session exists");return[2,t]}}))}))},t.prototype.forgotPassword=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.studentApiDriver.resetPassword(t)]}))}))},t.prototype.sessionLogout=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.deferred.untilOpen()];case 1:return t.sent(),[4,this.getTokenSession()];case 2:return[2,t.sent().destroy()]}}))}))},t.prototype.subjectLogout=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.deferred.untilOpen()];case 1:return t.sent(),[2,this.sessionService.globalLogout()]}}))}))},t.prototype.getAccessToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.deferred.untilOpen()];case 1:return t.sent(),[4,this.getTokenSession()];case 2:return[2,t.sent().getAccessToken()]}}))}))},t.prototype.getIdentityId=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.deferred.untilOpen()];case 1:return t.sent(),[4,this.getTokenSession()];case 2:return[2,t.sent().getUser().identityId]}}))}))},t.prototype.getEmail=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.deferred.untilOpen()];case 1:return t.sent(),[4,this.getTokenSession()];case 2:return[2,t.sent().getUser().email]}}))}))},t.prototype.isLoggedIn=function(){return"true"===this.browserSessionStorage.getItem(this.browserSessionStorageKey)},t.prototype.setLoginStatus=function(t){this.isLoggedInStatus=t,this.browserSessionStorage.setItem(this.browserSessionStorageKey,this.isLoggedInStatus)},r([u.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"initialize",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"onSessionServiceReady",null),r([u.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"onSessionCreated",null),r([u.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"onSessionDestroyed",null),r([u.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"notifySubscribers",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[Function]),i("design:returntype",Promise)],t.prototype,"subscribe",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Promise)],t.prototype,"forgotPassword",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"sessionLogout",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"subjectLogout",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getAccessToken",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getIdentityId",null),r([u.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getEmail",null),r([u.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"isLoggedIn",null),t}();e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.callback=t}return t.prototype.notify=function(t,e){try{this.callback(t,e)}catch(t){}},t}();e.CallbackSubscriberLegacy=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){this.message=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(20),i=function(){function t(t,e){this.baseUrl=t,this.fetch=e}return t.prototype.resetPassword=function(t){return this.sendRequest(r.RestCallType.POST,"/forgot-password",{Username:t})},t.prototype.sendRequest=function(t,e,n){var i={method:t,headers:{"Content-Type":"application/json"}};return t.toUpperCase()!==r.RestCallType.GET&&n&&(i.body=JSON.stringify(n)),this.fetch(this.baseUrl+e,i).then((function(t){return t.json()}))},t}();e.StudentapiDriver=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.getItem=function(t){try{window.sessionStorage.getItem(t)}catch(t){return null}},t.prototype.setItem=function(t,e){try{window.sessionStorage.setItem(t,e)}catch(t){}},t}();e.BrowserSessionStorage=r},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),s=n(177),a=n(16),u=function(){function t(t,e){this.eventAggregationService=t,this.tokenService=e}return t.prototype.create=function(t){var e=new s.TokenBasedSession(this.tokenService,this.eventAggregationService);return e.setCredentials(t),e},r([o.CatchReportException,i("design:type",Function),i("design:paramtypes",[a.Credentials]),i("design:returntype",Object)],t.prototype,"create",null),t}();e.TokenBasedSessionFactory=u},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(178),u=n(29),c=n(15),l=n(16),f=n(64),h=n(65),d=n(184),p=n(185),y=function(){function t(t,e){this.user=null,this.credentials=null,this.deferred=new u.Deferred,this.serverTime=new p.ServerTime,this.isUseablePromise=null,this.tokenService=t,this.eventAggregationService=e,this.deferred.open()}return t.prototype.getAccessToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.deferred.untilOpen()];case 1:return t.sent(),this.deferred.close(),[4,this.shouldRefresh()];case 2:return t.sent()?[4,this.refreshCredentials()]:(this.deferred.open(),[2,this.credentials.accessToken]);case 3:return[2,t.sent().accessToken]}}))}))},t.prototype.getRefreshToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.credentials.refreshToken]}))}))},t.prototype.destroy=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,,3,4]),[4,this.getAccessToken()];case 1:return t=e.sent(),[4,this.tokenService.logoutSession(t)];case 2:return e.sent(),[3,4];case 3:return this.eventAggregationService.publishSessionDestroyedEvent(),[7];case 4:return[2]}}))}))},t.prototype.getUser=function(){return this.user},t.prototype.getCredentials=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.credentials]}))}))},t.prototype.setCredentials=function(t){if(!this.isValidRefreshToken(t.refreshToken))throw this.eventAggregationService.publishSessionDestroyedEvent(),new f.RefreshTokenError("Not a valid refresh token.");if(null!==t.accessToken){var e=this.getTokenPayload(t.accessToken);this.setUser(e)}this.credentials=t},t.prototype.setUser=function(t){this.user=new d.Student(t.sub,t.email)},t.prototype.isUsable=function(){var t=this;return null!==this.isUseablePromise||(this.isUseablePromise=new Promise((function(e,n){return o(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.shouldRefresh()];case 1:if(!t.sent())return[2,e(!0)];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.refreshCredentials()];case 3:return t.sent(),[3,5];case 4:return t.sent(),e(!1),[3,5];case 5:return e(!0),[2]}}))}))}))),this.isUseablePromise},t.prototype.refreshCredentials=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.tokenService.refreshCredentials(this.credentials.refreshToken)];case 1:return t=n.sent(),this.setCredentials(t),this.eventAggregationService.publishSessionRefreshedEvent(),this.deferred.open(),[2,this.credentials];case 2:throw e=n.sent(),this.deferred.open(),e instanceof f.RefreshTokenError&&this.eventAggregationService.publishSessionDestroyedEvent(),e;case 3:return[2]}}))}))},t.prototype.isValidRefreshToken=function(t){return RegExp("[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}","g").test(t)},t.prototype.shouldRefresh=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return null===this.credentials||null===this.credentials.accessToken?[2,!0]:(t=this.getTokenPayload(this.credentials.accessToken).exp-5,[4,this.serverTime.now()]);case 1:return e=n.sent(),[2,t<=e]}}))}))},t.prototype.getTokenPayload=function(t){void 0===t&&(t="");try{var e=t.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(a(e))}catch(t){throw new h.InvalidAccessTokenError("Not a valid JWT.")}},r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getAccessToken",null),r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getRefreshToken",null),r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"destroy",null),r([c.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Object)],t.prototype,"getUser",null),r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getCredentials",null),r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[l.Credentials]),i("design:returntype",void 0)],t.prototype,"setCredentials",null),r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],t.prototype,"setUser",null),r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"isUsable",null),t}();e.TokenBasedSession=y},function(t,e,n){(function(t,e){!function(n){"use strict";var r,i="function"==typeof(r=n.atob)?r:"function"==typeof t?function(e){return new t(e,"base64").toString("binary")}:"object"==typeof n.base64js?function(t){var e=n.base64js.b64ToByteArray(t);return Array.prototype.map.call(e,(function(t){return String.fromCharCode(t)})).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};n.atob=i,e&&e.exports&&(e.exports=i)}(window)}).call(this,n(179).Buffer,n(183)(t))},function(t,e,n){"use strict";(function(t){var r=n(180),i=n(181),o=n(182);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=a(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(l(e),t=a(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|d(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(t).length;default:if(r)return F(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return R(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){f=!1;break}if(f)return o}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function _(t,e,n,r){return U(F(e,t.length-n),t,n,r)}function m(t,e,n,r){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return m(t,e,n,r)}function E(t,e,n,r){return U(B(e),t,n,r)}function T(t,e,n,r){return U(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}function R(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r,i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var o="",s=e;s<n;++s)o+=(r=t[s])<16?"0"+r.toString(16):r.toString(16);return o}function C(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(t,e,n,r,o){return o||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?a(null,e):void 0!==n?"string"==typeof r?a(null,e).fill(n,r):a(null,e).fill(n):a(null,e)}(0,t,e,n)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):y.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),f=0;f<a;++f)if(c[f]!==l[f]){o=c[f],s=l[f];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return _(this,t,e,n);case"ascii":return m(this,t,e,n);case"latin1":case"binary":return S(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||k(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||k(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);k(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);k(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:F(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var W=/[^+\/0-9A-Za-z-_]/g;function F(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function B(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(18))},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],s=n[1],a=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),u=0,l=s>0?r-4:r,f=0;f<l;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],a[u++]=e>>16&255,a[u++]=e>>8&255,a[u++]=255&e;return 2===s&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,a[u++]=255&e),1===s&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,a[u++]=e>>8&255,a[u++]=255&e),a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(t,s,s+16383>a?a:s+16383));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+t[e+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*y}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Student=function(t,e){this.identityId=t,this.email=e}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(33),s=n(13),a=function(){function t(){this.cachedTime={time:null,offset:null},this.storage=new o.DataStorageDriver,this.storageKey="SessionService/CachedTime",this.apiEndpoint="https://worldtimeapi.org/api/timezone/Etc/GMT"}return Object.defineProperty(t.prototype,"fetch",{get:function(){return s.default},enumerable:!0,configurable:!0}),t.prototype.syncDate=function(){return r(this,void 0,void 0,(function(){var t,e,n,r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.fetch(this.apiEndpoint,{})];case 1:return[4,i.sent().json()];case 2:return t=i.sent(),this.storeTimeInCache({time:t.unixtime,offset:Math.round(t.unixtime-this.getCurrentTime())}),[3,4];case 3:return i.sent(),this.storeTimeInCache({time:this.getCurrentTime(),offset:0}),[3,4];case 4:return e=this,r=(n=JSON).parse,[4,this.storage.get(this.storageKey)];case 5:return e.cachedTime=r.apply(n,[i.sent()]),[2]}}))}))},t.prototype.now=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this.storage.get(this.storageKey)];case 1:return(t=e.sent())?[3,3]:[4,this.syncDate()];case 2:return e.sent(),[3,4];case 3:this.cachedTime=JSON.parse(t),e.label=4;case 4:return[2,this.getCurrentTime()+this.cachedTime.offset]}}))}))},t.prototype.storeTimeInCache=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.storage.set(this.storageKey,JSON.stringify(t),2592e3)];case 1:return e.sent(),[2]}}))}))},t.prototype.getCurrentTime=function(){return Math.round(Date.now()/1e3)},t}();e.ServerTime=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(187),i=function(){function t(t,e,n){this.eventAggregationService=t,this.tokenSessionFactory=e,this.config=n}return t.prototype.createByBrowserNavigator=function(t){var e=this.isSafari(t);return new r.TokenBasedSessionRepository(this.eventAggregationService,this.tokenSessionFactory,this.config.hubUrl,e)},t.prototype.isSafari=function(t){return/Safari/.test(t.userAgent)&&(/Apple Computer/.test(t.vendor)||/CriOS/.test(t.userAgent))},t}();e.TokenBasedSessionRepositoryFactory=i},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(25),u=n(30),c=n(15),l=n(65),f=n(188),h=n(189),d=n(16),p=n(190),y=function(){function t(t,e,n,r){void 0===r&&(r=!1),this.eventAggregationService=t,this.tokenSessionFactory=e,this.hubURL=n,this.isCrossDomainDisabled=r,this.localStorageKey="SessionService/credentials",this.crossStorageKey="credentials",this.localStorage=a.DataStorage,this.isCrossDomainStorageSuccessfullyInitialized=null}return t.prototype.initialize=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:this.isCrossDomainStorageSuccessfullyInitialized=this.initializeCrossDomainStorage(),t.label=1;case 1:return t.trys.push([1,3,,7]),[4,this.get(h.SessionStorageType.Local)];case 2:return t.sent(),[3,7];case 3:return t.sent(),[4,this.isCrossDomainStorageSuccessfullyInitialized];case 4:return t.sent()?[4,this.copySessionWhenExists()]:[3,6];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return this.eventAggregationService.publishSessionRepositoryReadyEvent(),[2]}}))}))},t.prototype.copySessionWhenExists=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,this.get(h.SessionStorageType.CrossDomain)];case 1:return t=e.sent(),[4,this.save(t)];case 2:case 3:return e.sent(),[3,4];case 4:return[2]}}))}))},t.prototype.initializeCrossDomainStorage=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(this.isCrossDomainDisabled)return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),this.crossStorageClient=this.getNewCrossStorageClient(this.hubURL),[4,this.crossStorageClient.onConnect()];case 2:return t.sent(),[2,!0];case 3:return t.sent(),this.trackFallbackError(),[2,!1];case 4:return[2]}}))}))},t.prototype.getNewCrossStorageClient=function(t){return new u.CrossStorageClient(t,{timeout:3e4})},t.prototype.trackFallbackError=function(){if(void 0===window.snowplow)return null;window.snowplow("trackStructEvent","SessionService","fallback","localStorage")},t.prototype.get=function(t){return void 0===t&&(t=h.SessionStorageType.Local),o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,this.getSerializedCredentials(t)];case 1:if(null===(e=r.sent()))throw new p.SessionNotFoundError("There is no session in the session store");try{return n=JSON.parse(e),[2,this.tokenSessionFactory.create(n)]}catch(t){if(t instanceof l.InvalidAccessTokenError||t instanceof f.InvalidRefreshTokenError)throw t;throw new p.SessionNotFoundError(t.message)}return[2]}}))}))},t.prototype.getSerializedCredentials=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return t===h.SessionStorageType.Local?[2,this.localStorage.retrieve(this.localStorageKey)]:[2,this.crossStorageClient.get(this.crossStorageKey)]}))}))},t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,this.createSerializedCredentials(t)];case 1:return e=n.sent(),[4,this.storeSerializedCredentials(e)];case 2:return n.sent(),[2]}}))}))},t.prototype.storeSerializedCredentials=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=2592e3,this.localStorage.store(this.localStorageKey,t,e),[4,this.isCrossDomainStorageSuccessfullyInitialized];case 1:return n.sent()?[4,this.crossStorageClient.set(this.crossStorageKey,t,e)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.createSerializedCredentials=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return s(this,(function(i){switch(i.label){case 0:return n=d.Credentials.bind,[4,t.getAccessToken()];case 1:return r=[void 0,i.sent()],[4,t.getRefreshToken()];case 2:return e=new(n.apply(d.Credentials,r.concat([i.sent()]))),[2,JSON.stringify(e)]}}))}))},t.prototype.clear=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.localStorage.remove(this.localStorageKey),[4,this.isCrossDomainStorageSuccessfullyInitialized];case 1:return t.sent()?[4,this.crossStorageClient.del(this.crossStorageKey)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},r([c.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"initialize",null),t}();e.TokenBasedSessionRepository=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidRefreshTokenError=function(){this.message="The token is not a valid refresh token."}},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.SessionStorageType||(e.SessionStorageType={}))[r.CrossDomain=0]="CrossDomain",r[r.Local=1]="Local"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionNotFoundError=function(t){void 0===t&&(t=""),this.message=t}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(10),u=n(192),c=n(29),l=n(15),f=function(){function t(t,e,n){this.isReady=!1,this.session=null,this.tokenRepository=t,this.eventAggregationService=e,this.tokenService=n,this.deferred=new c.Deferred}return t.prototype.initialize=function(){this.eventAggregationService.subscribeToSessionRepositoryReadyEvent(this.onSessionRepositoryReady),this.eventAggregationService.subscribeToSessionDestroyedEvent(this.onSessionDestroyed),this.eventAggregationService.subscribeToSessionRefreshedEvent(this.onSessionRefreshed)},Object.defineProperty(t.prototype,"onSessionRepositoryReady",{get:function(){var t=this;return new a.CallbackSubscriber((function(){t.openSessionService()}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onSessionRefreshed",{get:function(){var t=this;return new u.OnceCallbackSubscriber((function(){return o(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.saveRefreshedSession()];case 1:return t.sent(),[2]}}))}))}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onSessionDestroyed",{get:function(){var t=this;return new a.CallbackSubscriber((function(){return o(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.clearSession()];case 1:return t.sent(),[2]}}))}))}))},enumerable:!0,configurable:!0}),t.prototype.getSession=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),null!==this.session?[3,2]:[4,this.loadSession()];case 1:t.sent(),t.label=2;case 2:return[4,this.session];case 3:return[2,t.sent()];case 4:return t.sent(),[2,null];case 5:return[2]}}))}))},t.prototype.setSession=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),this.deferred.untilOpen(),this.session=t,[4,t.getAccessToken()];case 1:return e.sent(),[4,this.tokenRepository.save(t)];case 2:return e.sent(),this.eventAggregationService.publishSessionCreatedEvent(t),[3,4];case 3:return e.sent(),this.session=null,this.eventAggregationService.publishSessionDestroyedEvent(),[3,4];case 4:return[2]}}))}))},t.prototype.globalLogout=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,this.tokenRepository.get()];case 1:return[4,e.sent().getAccessToken()];case 2:return t=e.sent(),[4,this.tokenService.logoutSubject(t)];case 3:case 4:return e.sent(),[3,5];case 5:return this.eventAggregationService.publishSessionDestroyedEvent(),[2]}}))}))},t.prototype.openSessionService=function(){this.deferred.open(),this.isReady=!0,this.eventAggregationService.publishSessionServiceReadyEvent(this)},t.prototype.saveRefreshedSession=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return e=(t=this.tokenRepository).save,[4,this.session];case 1:return[4,e.apply(t,[n.sent()])];case 2:return n.sent(),[2]}}))}))},t.prototype.clearSession=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.session=null,[4,this.tokenRepository.clear()];case 1:return t.sent(),[2]}}))}))},t.prototype.loadSession=function(){var t=this;null===this.session&&(this.session=new Promise((function(e,n){return o(t,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.tokenRepository.get()];case 1:return t=r.sent(),n=e,[4,t.isUsable()];case 2:return n.apply(void 0,[r.sent()?t:null]),[3,4];case 3:return r.sent(),e(null),[3,4];case 4:return[2]}}))}))})))},r([l.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"initialize",null),r([l.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"getSession",null),r([l.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Promise)],t.prototype,"setSession",null),r([l.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"globalLogout",null),r([l.CatchReportException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],t.prototype,"openSessionService",null),r([l.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"saveRefreshedSession",null),r([l.CatchReportAsyncException,i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],t.prototype,"clearSession",null),t}();e.TokenBasedSessionService=f},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var n=t.call(this,e)||this;return n.lastEventSent="",n}return i(e,t),e.prototype.notify=function(e){var n=JSON.stringify(e);this.lastEventSent!==n&&(this.lastEventSent=n,t.prototype.notify.call(this,e))},e}(n(10).CallbackSubscriber);e.OnceCallbackSubscriber=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(27),s=function(){function t(t){this.eventAggregationService=t}return t.prototype.notify=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return t instanceof o.SessionCreatedEvent?[2,this.initializeRollbarIdentity(t.session)]:[4,t.getSession()];case 1:return null===(e=n.sent())?(this.eventAggregationService.subscribeToSessionCreatedEvent(this),[2]):(this.initializeRollbarIdentity(e),[2])}}))}))},t.prototype.initializeRollbarIdentity=function(t){"undefined"!=typeof Rollbar&&Rollbar.configure({payload:{person:{id:t.getUser().identityId}}})},t}();e.RollbarIdentitySubscriber=s},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o,s=n(195),a=n(16),u=n(196),c=n(64);!function(t){t.Session="session",t.Subject="subject"}(o=e.LogoutMode||(e.LogoutMode={}));var l=function(){function t(t){this.baseUrl=t}return t.prototype.signRequest=function(t,e){t.headers.append("Authorization",e)},t.prototype.getRefreshTokenRequestOptions=function(t){var e=new s.Request(this.baseUrl+"/refresh",{method:"GET"});return this.signRequest(e,t),e},t.prototype.getLogoutTokenRequestOptions=function(t,e){var n=new s.Request(this.baseUrl+"/revoke?mode="+e,{method:"DELETE"});return this.signRequest(n,t),n},t.prototype.refreshCredentials=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch(this.getRefreshTokenRequestOptions(t))];case 1:return(e=r.sent()).ok?[4,e.json()]:[3,3];case 2:return n=r.sent(),[2,new a.Credentials(n.accessToken,n.refreshToken)];case 3:if(401===e.status)throw new c.RefreshTokenError("Refresh token unauthorized");r.label=4;case 4:throw new c.RefreshTokenError("Error while refreshing")}}))}))},t.prototype.logoutSession=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch(this.getLogoutTokenRequestOptions(t,o.Session))];case 1:if(!e.sent().ok)throw new u.LogoutError;return[2]}}))}))},t.prototype.logoutSubject=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch(this.getLogoutTokenRequestOptions(t,o.Subject))];case 1:if(!e.sent().ok)throw new u.LogoutError;return[2]}}))}))},t.prototype.fetch=function(t,e){return s.default(t,e)},t}();e.TokenService=l},function(t,e,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();t.exports=e=r.fetch,e.default=r.fetch.bind(r),e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogoutError=function(){this.message="There was a problem while logging out."}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(200),n(169),n(157),n(66)},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function a(t,e,n,r){var i=e&&e.prototype instanceof l?e:l,o=Object.create(i.prototype),s=new S(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===c)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,s),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=a;var c={};function l(){}function f(){}function h(){}var d={};d[i]=function(){return this};var p=Object.getPrototypeOf,y=p&&p(p(E([])));y&&y!==e&&n.call(y,i)&&(d=y);var v=h.prototype=l.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function b(t){var e;this._invoke=function(r,i){function o(){return new Promise((function(e,o){!function e(r,i,o,s){var a=u(t[r],t,i);if("throw"!==a.type){var c=a.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,s)}),(function(t){e("throw",t,o,s)})):Promise.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return e("throw",t,o,s)}))}s(a.arg)}(r,i,e,o)}))}return e=e?e.then(o,o):o()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,c;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function m(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=v.constructor=h,h.constructor=f,h[s]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},g(b.prototype),b.prototype[o]=function(){return this},t.AsyncIterator=b,t.async=function(e,n,r,i){var o=new b(a(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},g(v),v[s]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=E,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(m),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),m(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;m(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}}]);
//# sourceMappingURL=bundle.js.map